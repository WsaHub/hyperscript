var __extends=this&&this.__extends||function(){var e=function(t,r){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))e[r]=t[r]};return e(t,r)};return function(t,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var __values=this&&this.__values||function(e){var t=typeof Symbol==="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length==="number")return{next:function(){if(e&&n>=e.length)e=void 0;return{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(e,t){var r=t(e);if(typeof exports==="object"&&typeof exports["nodeName"]!=="string"){module.exports=r}else{e["_hyperscript"]=r;if("document"in e)e["_hyperscript"].browserInit()}})(typeof self!=="undefined"?self:undefined,(function(e){"use strict";var t={dynamicResolvers:[function(e,t){if(e==="Fixed"){return Number(t).toFixed()}else if(e.indexOf("Fixed:")===0){var r=e.split(":")[1];return Number(t).toFixed(parseInt(r))}}],String:function(e){if(e.toString){return e.toString()}else{return""+e}},Int:function(e){return parseInt(e)},Float:function(e){return parseFloat(e)},Number:function(e){return Number(e)},Date:function(e){return new Date(e)},Array:function(e){return Array.from(e)},JSON:function(e){return JSON.stringify(e)},Object:function(e){if(e instanceof String){e=e.toString()}if(typeof e==="string"){return JSON.parse(e)}else{return Object.assign({},e)}}};var r={attributes:"_, script, data-script",hideShowStrategies:undefined,defaultHideShowStrategy:undefined,defaultTransition:"all 500ms ease-in",disableSelector:"[disable-scripting], [data-disable-scripting]",conversions:t};var n=function(){function e(){}e.isValidCSSClassChar=function(t){return e.isAlpha(t)||e.isNumeric(t)||t==="-"||t==="_"||t===":"};e.isValidCSSIDChar=function(t){return e.isAlpha(t)||e.isNumeric(t)||t==="-"||t==="_"||t===":"};e.isWhitespace=function(t){return t===" "||t==="\t"||e.isNewline(t)};e.positionString=function(e){return"[Line: "+e.line+", Column: "+e.column+"]"};e.isNewline=function(e){return e==="\r"||e==="\n"};e.isNumeric=function(e){return e>="0"&&e<="9"};e.isAlpha=function(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"};e.isIdentifierChar=function(e){return e==="_"||e==="$"};e.isReservedChar=function(e){return e==="`"||e==="^"};e.isValidSingleQuoteStringStart=function(e){if(e.length>0){var t=e[e.length-1];if(t.type==="IDENTIFIER"||t.type==="CLASS_REF"||t.type==="ID_REF"){return false}if(t.op&&(t.value===">"||t.value===")")){return false}}return true};e.tokenize=function(t,r){var n=[];var a=t;var o=0;var u=0;var s=1;var l="<START>";var f=0;function c(){return r&&f===0}while(o<a.length){if(S()==="-"&&q()==="-"&&(e.isWhitespace(N(2))||N(2)===""||N(2)==="-")||S()==="/"&&q()==="/"){v()}else if(S()==="/"&&q()==="*"){h()}else{if(e.isWhitespace(S())){n.push(C())}else if(!R()&&S()==="."&&(e.isAlpha(q())||q()==="{")){n.push(d())}else if(!R()&&S()==="#"&&(e.isAlpha(q())||q()==="{")){n.push(k())}else if(S()==="["&&q()==="@"){n.push(y())}else if(S()==="@"){n.push(E())}else if(S()==="*"&&e.isAlpha(q())){n.push(T())}else if(e.isAlpha(S())||!c()&&e.isIdentifierChar(S())){n.push(x())}else if(e.isNumeric(S())){n.push(g())}else if(!c()&&(S()==='"'||S()==="`")){n.push(w())}else if(!c()&&S()==="'"){if(e.isValidSingleQuoteStringStart(n)){n.push(w())}else{n.push(b())}}else if(e.OP_TABLE[S()]){if(l==="$"&&S()==="{"){f++}if(S()==="}"){f--}n.push(b())}else if(c()||e.isReservedChar(S())){n.push(m("RESERVED",I()))}else{if(o<a.length){throw Error("Unknown token: "+S()+" ")}}}}return new i(n,[],a);function p(e,t){var r=m(e,t);r.op=true;return r}function m(e,t){return{type:e,value:t||"",start:o,end:o+1,column:u,line:s}}function v(){while(S()&&!e.isNewline(S())){I()}I()}function h(){while(S()&&!(S()==="*"&&q()==="/")){I()}I();I()}function d(){var t=m("CLASS_REF");var r=I();if(S()==="{"){t.template=true;r+=I();while(S()&&S()!=="}"){r+=I()}if(S()!=="}"){throw Error("Unterminated class reference")}else{r+=I()}}else{while(e.isValidCSSClassChar(S())){r+=I()}}t.value=r;t.end=o;return t}function y(){var e=m("ATTRIBUTE_REF");var t=I();while(o<a.length&&S()!=="]"){t+=I()}if(S()==="]"){t+=I()}e.value=t;e.end=o;return e}function E(){var t=m("ATTRIBUTE_REF");var r=I();while(e.isValidCSSIDChar(S())){r+=I()}t.value=r;t.end=o;return t}function T(){var t=m("STYLE_REF");var r=I();while(e.isAlpha(S())||S()==="-"){r+=I()}t.value=r;t.end=o;return t}function k(){var t=m("ID_REF");var r=I();if(S()==="{"){t.template=true;r+=I();while(S()&&S()!=="}"){r+=I()}if(S()!=="}"){throw Error("Unterminated id reference")}else{I()}}else{while(e.isValidCSSIDChar(S())){r+=I()}}t.value=r;t.end=o;return t}function x(){var t=m("IDENTIFIER");var r=I();while(e.isAlpha(S())||e.isNumeric(S())||e.isIdentifierChar(S())){r+=I()}if(S()==="!"&&r==="beep"){r+=I()}t.value=r;t.end=o;return t}function g(){var t=m("NUMBER");var r=I();while(e.isNumeric(S())){r+=I()}if(S()==="."&&e.isNumeric(q())){r+=I()}while(e.isNumeric(S())){r+=I()}t.value=r;t.end=o;return t}function b(){var t=p();var r=I();while(S()&&e.OP_TABLE[r+S()]){r+=I()}t.type=e.OP_TABLE[r];t.value=r;t.end=o;return t}function w(){var t=m("STRING");var r=I();var n="";while(S()&&S()!==r){if(S()==="\\"){I();var i=I();if(i==="b"){n+="\b"}else if(i==="f"){n+="\f"}else if(i==="n"){n+="\n"}else if(i==="r"){n+="\r"}else if(i==="t"){n+="\t"}else if(i==="v"){n+="\v"}else{n+=i}}else{n+=I()}}if(S()!==r){throw Error("Unterminated string at "+e.positionString(t))}else{I()}t.value=n;t.end=o;t.template=r==="`";return t}function S(){return a.charAt(o)}function q(){return a.charAt(o+1)}function N(e){if(e===void 0){e=1}return a.charAt(o+e)}function I(){l=S();o++;u++;return l}function R(){return e.isAlpha(l)||e.isNumeric(l)||l===")"||l==='"'||l==="'"||l==="`"||l==="}"||l==="]"}function C(){var t=m("WHITESPACE");var r="";while(S()&&e.isWhitespace(S())){if(e.isNewline(S())){u=0;s++}r+=I()}t.value=r;t.end=o;return t}};e.prototype.tokenize=function(t,r){return e.tokenize(t,r)};e.OP_TABLE={"+":"PLUS","-":"MINUS","*":"MULTIPLY","/":"DIVIDE",".":"PERIOD","..":"ELLIPSIS","\\":"BACKSLASH",":":"COLON","%":"PERCENT","|":"PIPE","!":"EXCLAMATION","?":"QUESTION","#":"POUND","&":"AMPERSAND",$:"DOLLAR",";":"SEMI",",":"COMMA","(":"L_PAREN",")":"R_PAREN","<":"L_ANG",">":"R_ANG","<=":"LTE_ANG",">=":"GTE_ANG","==":"EQ","===":"EQQ","!=":"NEQ","!==":"NEQQ","{":"L_BRACE","}":"R_BRACE","[":"L_BRACKET","]":"R_BRACKET","=":"EQUALS"};return e}();var i=function(){function e(e,t,r){this._lastConsumed=null;this.follows=[];this.tokens=e;this.consumed=t;this.source=r;this.consumeWhitespace()}Object.defineProperty(e.prototype,"list",{get:function(){return this.tokens},enumerable:false,configurable:true});e.prototype.consumeWhitespace=function(){while(this.token(0,true).type==="WHITESPACE"){this.consumed.push(this.tokens.shift())}};e.prototype.raiseError=function(e,t){a.raiseParseError(e,t)};e.prototype.requireOpToken=function(e){var t=this.matchOpToken(e);if(t){return t}else{this.raiseError(this,"Expected '"+e+"' but found '"+this.currentToken().value+"'")}};e.prototype.matchAnyOpToken=function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];var r=this.matchOpToken(t);if(r){return r}}};e.prototype.matchAnyToken=function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];var r=this.matchToken(t);if(r){return r}}};e.prototype.matchOpToken=function(e){if(this.currentToken()&&this.currentToken().op&&this.currentToken().value===e){return this.consumeToken()}};e.prototype.requireTokenType=function(e,t,r,n){var i=this.matchTokenType(e,t,r,n);if(i){return i}else{this.raiseError(this,"Expected one of "+JSON.stringify([e,t,r]))}};e.prototype.matchTokenType=function(e,t,r,n){if(this.currentToken()&&this.currentToken().type&&[e,t,r,n].indexOf(this.currentToken().type)>=0){return this.consumeToken()}};e.prototype.requireToken=function(e,t){var r=this.matchToken(e,t);if(r){return r}else{this.raiseError(this,"Expected '"+e+"' but found '"+this.currentToken().value+"'")}};e.prototype.peekToken=function(e,t,r){return this.tokens[t]&&this.tokens[t].value===e&&this.tokens[t].type===r};e.prototype.matchToken=function(e,t){if(t===void 0){t="IDENTIFIER"}if(this.follows.indexOf(e)!==-1){return}t=t||"IDENTIFIER";if(this.currentToken()&&this.currentToken().value===e&&this.currentToken().type===t){return this.consumeToken()}};e.prototype.consumeToken=function(){var e=this.tokens.shift();this.consumed.push(e);this._lastConsumed=e;this.consumeWhitespace();return e};e.prototype.consumeUntil=function(e,t){var r=[];var n=this.token(0,true);while((t==null||n.type!==t)&&(e==null||n.value!==e)&&n.type!=="EOF"){var i=this.tokens.shift();this.consumed.push(i);r.push(n);n=this.token(0,true)}this.consumeWhitespace();return r};e.prototype.lastWhitespace=function(){if(this.consumed[this.consumed.length-1]&&this.consumed[this.consumed.length-1].type==="WHITESPACE"){return this.consumed[this.consumed.length-1].value}else{return""}};e.prototype.consumeUntilWhitespace=function(){return this.consumeUntil(null,"WHITESPACE")};e.prototype.hasMore=function(){return this.tokens.length>0};e.prototype.token=function(e,t){if(t===void 0){t=false}var r;var n=0;do{if(!t){while(this.tokens[n]&&this.tokens[n].type==="WHITESPACE"){n++}}r=this.tokens[n];e--;n++}while(e>-1);if(r){return r}else{return{type:"EOF",value:"<<<EOF>>>"}}};e.prototype.currentToken=function(){return this.token(0)};e.prototype.lastMatch=function(){return this._lastConsumed};e.prototype.pushFollow=function(e){this.follows.push(e)};e.prototype.popFollow=function(){this.follows.pop()};e.prototype.clearFollows=function(){var e=this.follows;this.follows=[];return e};e.prototype.restoreFollows=function(e){this.follows=e};e.sourceFor=function(){return this.programSource.substring(this.startToken.start,this.endToken.end)};e.lineFor=function(){return this.programSource.split("\n")[this.startToken.line-1]};return e}();var a=function(){function e(e){this.GRAMMAR={};this.COMMANDS={};this.FEATURES={};this.LEAF_EXPRESSIONS=[];this.INDIRECT_EXPRESSIONS=[];this.runtime=e;this.possessivesDisabled=false;this.addGrammarElement("feature",(function(e,t,r){if(r.matchOpToken("(")){var n=e.requireElement("feature",r);r.requireOpToken(")");return n}var i=e.FEATURES[r.currentToken().value||""];if(i){return i(e,t,r)}}));this.addGrammarElement("command",(function(e,t,r){if(r.matchOpToken("(")){var n=e.requireElement("command",r);r.requireOpToken(")");return n}var i=e.COMMANDS[r.currentToken().value||""];var a;if(i){a=i(e,t,r)}else if(r.currentToken().type==="IDENTIFIER"){a=e.parseElement("pseudoCommand",r)}if(a){return e.parseElement("indirectStatement",r,a)}return a}));this.addGrammarElement("commandList",(function(e,t,r){var n=e.parseElement("command",r);if(n){r.matchToken("then");var i=e.parseElement("commandList",r);if(i)n.next=i;return n}}));this.addGrammarElement("leaf",(function(e,t,r){var n=e.parseAnyOf(e.LEAF_EXPRESSIONS,r);if(n==null){return e.parseElement("symbol",r)}return n}));this.addGrammarElement("indirectExpression",(function(e,t,r,n){for(var i=0;i<e.INDIRECT_EXPRESSIONS.length;i++){var a=e.INDIRECT_EXPRESSIONS[i];n.endToken=r.lastMatch();var o=e.parseElement(a,r,n);if(o){return o}}return n}));this.addGrammarElement("indirectStatement",(function(e,t,r,n){if(r.matchToken("unless")){n.endToken=r.lastMatch();var i=e.requireElement("expression",r);var a={type:"unlessStatementModifier",args:[i],op:function(e,t){if(t){return this.next}else{return n}},execute:function(e){return t.unifiedExec(this,e)}};n.parent=a;return a}return n}));this.addGrammarElement("primaryExpression",(function(e,t,r){var n=e.parseElement("leaf",r);if(n){return e.parseElement("indirectExpression",r,n)}e.raiseParseError(r,"Unexpected value: "+r.currentToken().value)}))}e.prototype.use=function(e){e(this);return this};e.prototype.initElt=function(e,t,r){e.startToken=t;e.sourceFor=i.sourceFor;e.lineFor=i.lineFor;e.programSource=r.source};e.prototype.parseElement=function(e,t,r){var n=this.GRAMMAR[e];if(n){var i=t.currentToken();var a=n(this,this.runtime,t,r);if(a){this.initElt(a,i,t);a.endToken=a.endToken||t.lastMatch();var r=a.root;while(r!=null){this.initElt(r,i,t);r=r.root}}return a}};e.prototype.requireElement=function(t,r,n,i){var a=this.parseElement(t,r,i);if(!a)e.raiseParseError(r,n||"Expected "+t);return a};e.prototype.parseAnyOf=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];var i=this.parseElement(n,t);if(i){return i}}};e.prototype.addGrammarElement=function(e,t){this.GRAMMAR[e]=t};e.prototype.addCommand=function(e,t){var r=e+"Command";var n=function(e,n,i){var a=t(e,n,i);if(a){a.type=r;a.execute=function(e){e.meta.command=a;return n.unifiedExec(this,e)};return a}};this.GRAMMAR[r]=n;this.COMMANDS[e]=n};e.prototype.addFeature=function(e,t){var r=e+"Feature";var n=function(n,i,a){var o=t(n,i,a);if(o){o.isFeature=true;o.keyword=e;o.type=r;return o}};this.GRAMMAR[r]=n;this.FEATURES[e]=n};e.prototype.addLeafExpression=function(e,t){this.LEAF_EXPRESSIONS.push(e);this.addGrammarElement(e,t)};e.prototype.addIndirectExpression=function(e,t){this.INDIRECT_EXPRESSIONS.push(e);this.addGrammarElement(e,t)};e.createParserContext=function(e){var t=e.currentToken();var r=e.source;var n=r.split("\n");var i=t&&t.line?t.line-1:n.length-1;var a=n[i];var o=t&&t.line?t.column:a.length-1;return a+"\n"+" ".repeat(o)+"^^\n\n"};e.raiseParseError=function(t,r){r=(r||"Unexpected Token : "+t.currentToken().value)+"\n\n"+e.createParserContext(t);var n=new Error(r);n["tokens"]=t;throw n};e.prototype.raiseParseError=function(t,r){e.raiseParseError(t,r)};e.prototype.parseHyperScript=function(e){var t=this.parseElement("hyperscript",e);if(e.hasMore())this.raiseParseError(e);if(t)return t};e.prototype.setParent=function(e,t){if(typeof e==="object"){e.parent=t;if(typeof t==="object"){t.children=t.children||new Set;t.children.add(e)}this.setParent(e.next,t)}};e.prototype.commandStart=function(e){return this.COMMANDS[e.value||""]};e.prototype.featureStart=function(e){return this.FEATURES[e.value||""]};e.prototype.commandBoundary=function(e){if(e.value=="end"||e.value=="then"||e.value=="else"||e.value=="otherwise"||e.value==")"||this.commandStart(e)||this.featureStart(e)||e.type=="EOF"){return true}return false};e.prototype.parseStringTemplate=function(e){var t=[""];do{t.push(e.lastWhitespace());if(e.currentToken().value==="$"){e.consumeToken();var r=e.matchOpToken("{");t.push(this.requireElement("expression",e));if(r){e.requireOpToken("}")}t.push("")}else if(e.currentToken().value==="\\"){e.consumeToken();e.consumeToken()}else{var n=e.consumeToken();t[t.length-1]+=n?n.value:""}}while(e.hasMore());t.push(e.lastWhitespace());return t};e.prototype.ensureTerminated=function(e){var t=this.runtime;var r={type:"implicitReturn",op:function(e){e.meta.returned=true;if(e.meta.resolve){e.meta.resolve()}return t.HALT},execute:function(e){}};var n=e;while(n.next){n=n.next}n.next=r};return e}();var o=function(){function o(t,r){this.HALT=o.HALT;this._scriptAttrs=null;this.hyperscriptFeaturesMap=new WeakMap;this.internalDataMap=new WeakMap;this.hyperscriptUrl="document"in e?document.currentScript.src:null;this.lexer=t!==null&&t!==void 0?t:new n;this.parser=r!==null&&r!==void 0?r:new a(this).use(v).use(h);this.parser.runtime=this}o.prototype.matchesSelector=function(e,t){var r=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector;return r&&r.call(e,t)};o.prototype.makeEvent=function(t,r){var n;if(e.Event&&typeof e.Event==="function"){n=new Event(t,{bubbles:true,cancelable:true});n["detail"]=r}else{n=document.createEvent("CustomEvent");n.initCustomEvent(t,true,true,r)}return n};o.prototype.triggerEvent=function(e,t,r,n){r=r||{};r["sender"]=n;var i=this.makeEvent(t,r);var a=e.dispatchEvent(i);return a};o.prototype.isArrayLike=function(e){return Array.isArray(e)||typeof NodeList!=="undefined"&&(e instanceof NodeList||e instanceof HTMLCollection)};o.prototype.isIterable=function(e){return typeof e==="object"&&Symbol.iterator in e&&typeof e[Symbol.iterator]==="function"};o.prototype.shouldAutoIterate=function(e){return e!=null&&e[l]||this.isArrayLike(e)};o.prototype.forEach=function(e,t){var r,n;if(e==null){}else if(this.isIterable(e)){try{for(var i=__values(e),a=i.next();!a.done;a=i.next()){var o=a.value;t(o)}}catch(e){r={error:e}}finally{try{if(a&&!a.done&&(n=i.return))n.call(i)}finally{if(r)throw r.error}}}else if(this.isArrayLike(e)){for(var u=0;u<e.length;u++){t(e[u])}}else{t(e)}};o.prototype.implicitLoop=function(e,t){var r,n;if(this.shouldAutoIterate(e)){try{for(var i=__values(e),a=i.next();!a.done;a=i.next()){var o=a.value;t(o)}}catch(e){r={error:e}}finally{try{if(a&&!a.done&&(n=i.return))n.call(i)}finally{if(r)throw r.error}}}else{t(e)}};o.prototype.wrapArrays=function(e){var t=[];for(var r=0;r<e.length;r++){var n=e[r];if(Array.isArray(n)){t.push(Promise.all(n))}else{t.push(n)}}return t};o.prototype.unwrapAsyncs=function(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.asyncWrapper){e[t]=r.value}if(Array.isArray(r)){for(var n=0;n<r.length;n++){var i=r[n];if(i.asyncWrapper){r[n]=i.value}}}}};o.prototype.unifiedExec=function(e,t){var r=this;while(true){try{var n=this.unifiedEval(e,t)}catch(r){if(t.meta.handlingFinally){console.error(" Exception in finally block: ",r);n=o.HALT}else{this.registerHyperTrace(t,r);if(t.meta.errorHandler&&!t.meta.handlingError){t.meta.handlingError=true;t.locals[t.meta.errorSymbol]=r;e=t.meta.errorHandler;continue}else{t.meta.currentException=r;n=o.HALT}}}if(n==null){console.error(e," did not return a next element to execute! context: ",t);return}else if(n.then){n.then((function(e){r.unifiedExec(e,t)})).catch((function(e){r.unifiedExec({op:function(){throw e}},t)}));return}else if(n===o.HALT){if(t.meta.finallyHandler&&!t.meta.handlingFinally){t.meta.handlingFinally=true;e=t.meta.finallyHandler}else{if(t.meta.onHalt){t.meta.onHalt()}if(t.meta.currentException){if(t.meta.reject){t.meta.reject(t.meta.currentException);return}else{throw t.meta.currentException}}else{return}}}else{e=n}}};o.prototype.unifiedEval=function(e,t){var r=this;var n=[t];var i=false;var a=false;if(e.args){for(var o=0;o<e.args.length;o++){var u=e.args[o];if(u==null){n.push(null)}else if(Array.isArray(u)){var s=[];for(var l=0;l<u.length;l++){var f=u[l];var c=f?f.evaluate(t):null;if(c){if(c.then){i=true}else if(c.asyncWrapper){a=true}}s.push(c)}n.push(s)}else if(u.evaluate){var c=u.evaluate(t);if(c){if(c.then){i=true}else if(c.asyncWrapper){a=true}}n.push(c)}else{n.push(u)}}}if(i){return new Promise((function(t,i){n=r.wrapArrays(n);Promise.all(n).then((function(r){if(a){this.unwrapAsyncs(r)}try{var n=e.op.apply(e,r);t(n)}catch(e){i(e)}})).catch((function(e){i(e)}))}))}else{if(a){this.unwrapAsyncs(n)}return e.op.apply(e,n)}};o.prototype.getScriptAttributes=function(){if(this._scriptAttrs==null){this._scriptAttrs=r.attributes.replace(/ /g,"").split(",")}return this._scriptAttrs};o.prototype.getScript=function(e){for(var t=0;t<this.getScriptAttributes().length;t++){var r=this.getScriptAttributes()[t];if(e.hasAttribute&&e.hasAttribute(r)){return e.getAttribute(r)}}if(e instanceof HTMLScriptElement&&e.type==="text/hyperscript"){return e.innerText}return null};o.prototype.getHyperscriptFeatures=function(e){var t=this.hyperscriptFeaturesMap.get(e);if(typeof t==="undefined"){if(e){this.hyperscriptFeaturesMap.set(e,t={})}}return t};o.prototype.addFeatures=function(e,t){if(e){Object.assign(t.locals,this.getHyperscriptFeatures(e));this.addFeatures(e.parentElement,t)}};o.prototype.makeContext=function(e,t,r,n){return new u(e,t,r,n,this)};o.prototype.getScriptSelector=function(){return this.getScriptAttributes().map((function(e){return"["+e+"]"})).join(", ")};o.prototype.convertValue=function(e,r){var n=t.dynamicResolvers;for(var i=0;i<n.length;i++){var a=n[i];var o=a(r,e);if(o!==undefined){return o}}if(e==null){return null}var u=t[r];if(u){return u(e)}throw"Unknown conversion : "+r};o.prototype.parse=function(e){var t=this.lexer,r=this.parser;var n=t.tokenize(e);if(this.parser.commandStart(n.currentToken())){var i=r.requireElement("commandList",n);if(n.hasMore())r.raiseParseError(n);r.ensureTerminated(i);return i}else if(r.featureStart(n.currentToken())){var a=r.requireElement("hyperscript",n);if(n.hasMore())r.raiseParseError(n);return a}else{var o=r.requireElement("expression",n);if(n.hasMore())r.raiseParseError(n);return o}};o.prototype.evaluateNoPromise=function(e,t){var r=e.evaluate(t);if(r.next){throw new Error(i.sourceFor.call(e)+" returned a Promise in a context that they are not allowed.")}return r};o.prototype.evaluate=function(t,r,n){if(n===void 0){n=undefined}var i=function(e){__extends(t,e);function t(t){var r=e.call(this)||this;r.module=t;return r}t.prototype.toString=function(){return this.module.id};return t}(EventTarget);var a="document"in e?e.document.body:new i(n&&n.module);r=Object.assign(this.makeContext(a,null,a,null),r||{});var o=this.parse(t);if(o.execute){o.execute(r);return r.result}else if(o.apply){o.apply(a,a,n);return this.getHyperscriptFeatures(a)}else{return o.evaluate(r)}function u(){return{}}};o.prototype.processNode=function(e){var t=this;var r=this.getScriptSelector();if(this.matchesSelector(e,r)){this.initElement(e,e)}if(e instanceof HTMLScriptElement&&e.type==="text/hyperscript"){this.initElement(e,document.body)}if(e.querySelectorAll){this.forEach(e.querySelectorAll(r+", [type='text/hyperscript']"),(function(e){t.initElement(e,e instanceof HTMLScriptElement&&e.type==="text/hyperscript"?document.body:e)}))}};o.prototype.initElement=function(e,t){var n=this;if(e.closest&&e.closest(r.disableSelector)){return}var i=this.getInternalData(e);if(!i.initialized){var a=this.getScript(e);if(a){try{i.initialized=true;i.script=a;var o=this.lexer,u=this.parser;var s=o.tokenize(a);var l=u.parseHyperScript(s);if(!l)return;l.apply(t||e,e);setTimeout((function(){n.triggerEvent(t||e,"load",{hyperscript:true})}),1)}catch(t){this.triggerEvent(e,"exception",{error:t});console.error("hyperscript errors were found on the following element:",e,"\n\n",t.message,t.stack)}}}};o.prototype.getInternalData=function(e){var t=this.internalDataMap.get(e);if(typeof t==="undefined"){this.internalDataMap.set(e,t={})}return t};o.prototype.typeCheck=function(e,t,r){if(e==null&&r){return true}var n=Object.prototype.toString.call(e).slice(8,-1);return n===t};o.prototype.getElementScope=function(e){var t=e.meta&&e.meta.owner;if(t){var r=this.getInternalData(t);var n="elementScope";if(e.meta.feature&&e.meta.feature.behavior){n=e.meta.feature.behavior+"Scope"}var i=f(r,n);return i}else{return{}}};o.prototype.isReservedWord=function(e){return["meta","it","result","locals","event","target","detail","sender","body"].includes(e)};o.prototype.isHyperscriptContext=function(e){return e instanceof u};o.prototype.resolveSymbol=function(t,r,n){if(t==="me"||t==="my"||t==="I"){return r.me}if(t==="it"||t==="its"||t==="result"){return r.result}if(t==="you"||t==="your"||t==="yourself"){return r.you}else{if(n==="global"){return e[t]}else if(n==="element"){var i=this.getElementScope(r);return i[t]}else if(n==="local"){return r.locals[t]}else{if(r.meta&&r.meta.context){var a=r.meta.context[t];if(typeof a!=="undefined"){return a}}if(this.isHyperscriptContext(r)&&!this.isReservedWord(t)){var o=r.locals[t]}else{var o=r[t]}if(typeof o!=="undefined"){return o}else{var i=this.getElementScope(r);o=i[t];if(typeof o!=="undefined"){return o}else{return e[t]}}}}};o.prototype.setSymbol=function(t,r,n,i){if(n==="global"){e[t]=i}else if(n==="element"){var a=this.getElementScope(r);a[t]=i}else if(n==="local"){r.locals[t]=i}else{if(this.isHyperscriptContext(r)&&!this.isReservedWord(t)&&typeof r.locals[t]!=="undefined"){r.locals[t]=i}else{var a=this.getElementScope(r);var o=a[t];if(typeof o!=="undefined"){a[t]=i}else{if(this.isHyperscriptContext(r)&&!this.isReservedWord(t)){r.locals[t]=i}else{r[t]=i}}}}};o.prototype.findNext=function(e,t){if(e){if(e.resolveNext){return e.resolveNext(t)}else if(e.next){return e.next}else{return this.findNext(e.parent,t)}}};o.prototype.flatGet=function(e,t,r){var n,i;if(e!=null){var a=r(e,t);if(typeof a!=="undefined"){return a}if(this.shouldAutoIterate(e)){var o=[];try{for(var u=__values(e),s=u.next();!s.done;s=u.next()){var l=s.value;var f=r(l,t);o.push(f)}}catch(e){n={error:e}}finally{try{if(s&&!s.done&&(i=u.return))i.call(u)}finally{if(n)throw n.error}}return o}}};o.prototype.resolveProperty=function(e,t){return this.flatGet(e,t,(function(e,t){return e[t]}))};o.prototype.resolveAttribute=function(e,t){return this.flatGet(e,t,(function(e,t){return e.getAttribute&&e.getAttribute(t)}))};o.prototype.resolveStyle=function(e,t){return this.flatGet(e,t,(function(e,t){return e.style&&e.style[t]}))};o.prototype.resolveComputedStyle=function(e,t){return this.flatGet(e,t,(function(e,t){return getComputedStyle(e).getPropertyValue(t)}))};o.prototype.assignToNamespace=function(t,r,n,i){var a;if(typeof document!=="undefined"&&t===document.body){a=e}else{a=this.getHyperscriptFeatures(t)}var o;while((o=r.shift())!==undefined){var u=a[o];if(u==null){u={};a[o]=u}a=u}a[n]=i};o.prototype.getHyperTrace=function(e,t){var r=[];var n=e;while(n.meta.caller){n=n.meta.caller}if(n.meta.traceMap){return n.meta.traceMap.get(t,r)}};o.prototype.registerHyperTrace=function(e,t){var r=[];var n=null;while(e!=null){r.push(e);n=e;e=e.meta.caller}if(n.meta.traceMap==null){n.meta.traceMap=new Map}if(!n.meta.traceMap.get(t)){var i={trace:r,print:function(e){e=e||console.error;e("hypertrace /// ");var t=0;for(var n=0;n<r.length;n++){t=Math.max(t,r[n].meta.feature.displayName.length)}for(var n=0;n<r.length;n++){var i=r[n];e("  ->",i.meta.feature.displayName.padEnd(t+2),"-",i.meta.owner)}}};n.meta.traceMap.set(t,i)}};o.prototype.escapeSelector=function(e){return e.replace(/:/g,(function(e){return"\\"+e}))};o.prototype.nullCheck=function(e,t){if(e==null){throw new Error("'"+t.sourceFor()+"' is null")}};o.prototype.isEmpty=function(e){return e==undefined||e.length===0};o.prototype.doesExist=function(e){var t,r;if(e==null){return false}if(this.shouldAutoIterate(e)){try{for(var n=__values(e),i=n.next();!i.done;i=n.next()){var a=i.value;return true}}catch(e){t={error:e}}finally{try{if(i&&!i.done&&(r=n.return))r.call(n)}finally{if(t)throw t.error}}}return false};o.prototype.getRootNode=function(e){if(e&&e instanceof Node){var t=e.getRootNode();if(t instanceof Document||t instanceof ShadowRoot)return t}return document};o.prototype.getEventQueueFor=function(e,t){var r=this.getInternalData(e);var n=r.eventQueues;if(n==null){n=new Map;r.eventQueues=n}var i=n.get(t);if(i==null){i={queue:[],executing:false};n.set(t,i)}return i};o.HALT={};return o}();var u=function(){function t(t,r,n,i,a){this.meta={parser:a.parser,lexer:a.lexer,runtime:a,owner:t,feature:r,iterators:{},ctx:this};this.locals={};this.me=n,this.you=undefined;this.result=undefined;this.event=i;this.target=i?i.target:null;this.detail=i?i.detail:null;this.sender=i?i.detail?i.detail.sender:null:null;this.body="document"in e?document.body:null;a.addFeatures(t,this)}return t}();var s=function(){function e(e,t,r){if(r===void 0){r=undefined}this._css=e;this.relativeToElement=t;this.escape=r;this[l]=true}Object.defineProperty(e.prototype,"css",{get:function(){if(this.escape){return o.prototype.escapeSelector(this._css)}else{return this._css}},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"className",{get:function(){return this._css.substr(1)},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"id",{get:function(){return this.className()},enumerable:false,configurable:true});e.prototype.contains=function(e){var t,r;try{for(var n=__values(this),i=n.next();!i.done;i=n.next()){var a=i.value;if(a.contains(e)){return true}}}catch(e){t={error:e}}finally{try{if(i&&!i.done&&(r=n.return))r.call(n)}finally{if(t)throw t.error}}return false};Object.defineProperty(e.prototype,"length",{get:function(){return this.selectMatches().length},enumerable:false,configurable:true});e.prototype[Symbol.iterator]=function(){var e=this.selectMatches();return e[Symbol.iterator]()};e.prototype.selectMatches=function(){var e=o.prototype.getRootNode(this.relativeToElement).querySelectorAll(this.css);return e};return e}();var l=Symbol();function f(e,t){var r=e[t];if(r){return r}else{var n={};e[t]=n;return n}}function c(e){try{return JSON.parse(e)}catch(e){p(e);return null}}function p(e){if(console.error){console.error(e)}else if(console.log){console.log("ERROR: ",e)}}function m(e,t){return new(e.bind.apply(e,[e].concat(t)))}function v(t){t.addLeafExpression("parenthesized",(function(e,t,r){if(r.matchOpToken("(")){var n=r.clearFollows();try{var i=e.requireElement("expression",r)}finally{r.restoreFollows(n)}r.requireOpToken(")");return i}}));t.addLeafExpression("string",(function(e,t,r){var i=r.matchTokenType("STRING");if(!i)return;var a=i.value;var o;if(i.template){var u=n.tokenize(a,true);o=e.parseStringTemplate(u)}else{o=[]}return{type:"string",token:i,args:o,op:function(e){var t="";for(var r=1;r<arguments.length;r++){var n=arguments[r];if(n!==undefined){t+=n}}return t},evaluate:function(e){if(o.length===0){return a}else{return t.unifiedEval(this,e)}}}}));t.addGrammarElement("nakedString",(function(e,t,r){if(r.hasMore()){var n=r.consumeUntilWhitespace();r.matchTokenType("WHITESPACE");return{type:"nakedString",tokens:n,evaluate:function(e){return n.map((function(e){return e.value})).join("")}}}}));t.addLeafExpression("number",(function(e,t,r){var n=r.matchTokenType("NUMBER");if(!n)return;var i=n;var a=parseFloat(n.value);return{type:"number",value:a,numberToken:i,evaluate:function(){return a}}}));t.addLeafExpression("idRef",(function(e,t,r){var i=r.matchTokenType("ID_REF");if(!i)return;if(!i.value)return;if(i.template){var a=i.value.substring(2);var o=n.tokenize(a);var u=e.requireElement("expression",o);return{type:"idRefTemplate",args:[u],op:function(e,r){return t.getRootNode(e.me).getElementById(r)},evaluate:function(e){return t.unifiedEval(this,e)}}}else{var s=i.value.substring(1);return{type:"idRef",css:i.value,value:s,evaluate:function(e){return t.getRootNode(e.me).getElementById(s)}}}}));t.addLeafExpression("classRef",(function(e,t,r){var i=r.matchTokenType("CLASS_REF");if(!i)return;if(!i.value)return;if(i.template){var a=i.value.substring(2);var o=n.tokenize(a);var u=e.requireElement("expression",o);return{type:"classRefTemplate",args:[u],op:function(e,t){return new s("."+t,e.me,true)},evaluate:function(e){return t.unifiedEval(this,e)}}}else{var l=i.value;return{type:"classRef",css:l,evaluate:function(e){return new s(l,e.me,true)}}}}));var r=function(e){__extends(t,e);function t(t,r,n){var i=e.call(this,t,r)||this;i.templateParts=n;i.elements=n.filter((function(e){return e instanceof Element}));return i}Object.defineProperty(t.prototype,"css",{get:function(){var e,t;var r="",n=0;try{for(var i=__values(this.templateParts),a=i.next();!a.done;a=i.next()){var o=a.value;if(o instanceof Element){r+="[data-hs-query-id='"+n+++"']"}else r+=o}}catch(t){e={error:t}}finally{try{if(a&&!a.done&&(t=i.return))t.call(i)}finally{if(e)throw e.error}}return r},enumerable:false,configurable:true});t.prototype[Symbol.iterator]=function(){this.elements.forEach((function(e,t){return e.dataset.hsQueryId=t}));var t=e.prototype[Symbol.iterator].call(this);this.elements.forEach((function(e){return e.removeAttribute("data-hs-query-id")}));return t};return t}(s);t.addLeafExpression("queryRef",(function(e,t,i){var a=i.matchOpToken("<");if(!a)return;var o=i.consumeUntil("/");i.requireOpToken("/");i.requireOpToken(">");var u=o.map((function(e){if(e.type==="STRING"){return'"'+e.value+'"'}else{return e.value}})).join("");var l,f,c;if(u.indexOf("$")>=0){l=true;f=n.tokenize(u,true);c=e.parseStringTemplate(f)}return{type:"queryRef",css:u,args:c,op:function(e){var t=[];for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}if(l){return new r(u,e.me,t)}else{return new s(u,e.me)}},evaluate:function(e){return t.unifiedEval(this,e)}}}));t.addLeafExpression("attributeRef",(function(e,t,r){var n=r.matchTokenType("ATTRIBUTE_REF");if(!n)return;if(!n.value)return;var i=n.value;if(i.indexOf("[")===0){var a=i.substring(2,i.length-1)}else{var a=i.substring(1)}var o="["+a+"]";var u=a.split("=");var s=u[0];var l=u[1];if(l){if(l.indexOf('"')===0){l=l.substring(1,l.length-1)}}return{type:"attributeRef",name:s,css:o,value:l,op:function(e){var t=e.you||e.me;if(t){return t.getAttribute(s)}},evaluate:function(e){return t.unifiedEval(this,e)}}}));t.addLeafExpression("styleRef",(function(e,t,r){var n=r.matchTokenType("STYLE_REF");if(!n)return;if(!n.value)return;var i=n.value.substr(1);if(i.startsWith("computed-")){i=i.substr("computed-".length);return{type:"computedStyleRef",name:i,op:function(e){var r=e.you||e.me;if(r){return t.resolveComputedStyle(r,i)}},evaluate:function(e){return t.unifiedEval(this,e)}}}else{return{type:"styleRef",name:i,op:function(e){var r=e.you||e.me;if(r){return t.resolveStyle(r,i)}},evaluate:function(e){return t.unifiedEval(this,e)}}}}));t.addGrammarElement("objectKey",(function(e,t,r){var n;if(n=r.matchTokenType("STRING")){return{type:"objectKey",key:n.value,evaluate:function(){return n.value}}}else if(r.matchOpToken("[")){var i=e.parseElement("expression",r);r.requireOpToken("]");return{type:"objectKey",expr:i,args:[i],op:function(e,t){return t},evaluate:function(e){return t.unifiedEval(this,e)}}}else{var a="";do{n=r.matchTokenType("IDENTIFIER")||r.matchOpToken("-");if(n)a+=n.value}while(n);return{type:"objectKey",key:a,evaluate:function(){return a}}}}));t.addLeafExpression("objectLiteral",(function(e,t,r){if(!r.matchOpToken("{"))return;var n=[];var i=[];if(!r.matchOpToken("}")){do{var a=e.requireElement("objectKey",r);r.requireOpToken(":");var o=e.requireElement("expression",r);i.push(o);n.push(a)}while(r.matchOpToken(","));r.requireOpToken("}")}return{type:"objectLiteral",args:[n,i],op:function(e,t,r){var n={};for(var i=0;i<t.length;i++){n[t[i]]=r[i]}return n},evaluate:function(e){return t.unifiedEval(this,e)}}}));t.addGrammarElement("nakedNamedArgumentList",(function(e,t,r){var n=[];var i=[];if(r.currentToken().type==="IDENTIFIER"){do{var a=r.requireTokenType("IDENTIFIER");r.requireOpToken(":");var o=e.requireElement("expression",r);i.push(o);n.push({name:a,value:o})}while(r.matchOpToken(","))}return{type:"namedArgumentList",fields:n,args:[i],op:function(e,t){var r={_namedArgList_:true};for(var i=0;i<t.length;i++){var a=n[i];r[a.name.value]=t[i]}return r},evaluate:function(e){return t.unifiedEval(this,e)}}}));t.addGrammarElement("namedArgumentList",(function(e,t,r){if(!r.matchOpToken("("))return;var n=e.requireElement("nakedNamedArgumentList",r);r.requireOpToken(")");return n}));t.addGrammarElement("symbol",(function(e,t,r){var n="default";if(r.matchToken("global")){n="global"}else if(r.matchToken("element")||r.matchToken("module")){n="element";if(r.matchOpToken("'")){r.requireToken("s")}}else if(r.matchToken("local")){n="local"}var i=r.matchOpToken(":");var a=r.matchTokenType("IDENTIFIER");if(a&&a.value){var o=a.value;if(i){o=":"+o}if(n==="default"){if(o.indexOf("$")===0){n="global"}if(o.indexOf(":")===0){n="element"}}return{type:"symbol",token:a,scope:n,name:o,evaluate:function(e){return t.resolveSymbol(o,e,n)}}}}));t.addGrammarElement("implicitMeTarget",(function(e,t,r){return{type:"implicitMeTarget",evaluate:function(e){return e.you||e.me}}}));t.addLeafExpression("boolean",(function(e,t,r){var n=r.matchToken("true")||r.matchToken("false");if(!n)return;var i=n.value==="true";return{type:"boolean",evaluate:function(e){return i}}}));t.addLeafExpression("null",(function(e,t,r){if(r.matchToken("null")){return{type:"null",evaluate:function(e){return null}}}}));t.addLeafExpression("arrayLiteral",(function(e,t,r){if(!r.matchOpToken("["))return;var n=[];if(!r.matchOpToken("]")){do{var i=e.requireElement("expression",r);n.push(i)}while(r.matchOpToken(","));r.requireOpToken("]")}return{type:"arrayLiteral",values:n,args:[n],op:function(e,t){return t},evaluate:function(e){return t.unifiedEval(this,e)}}}));t.addLeafExpression("blockLiteral",(function(e,t,r){if(!r.matchOpToken("\\"))return;var n=[];var i=r.matchTokenType("IDENTIFIER");if(i){n.push(i);while(r.matchOpToken(",")){n.push(r.requireTokenType("IDENTIFIER"))}}r.requireOpToken("-");r.requireOpToken(">");var a=e.requireElement("expression",r);return{type:"blockLiteral",args:n,expr:a,evaluate:function(e){var t=function(){for(var t=0;t<n.length;t++){e.locals[n[t].value]=arguments[t]}return a.evaluate(e)};return t}}}));t.addIndirectExpression("propertyAccess",(function(e,t,r,n){if(!r.matchOpToken("."))return;var i=r.requireTokenType("IDENTIFIER");var a={type:"propertyAccess",root:n,prop:i,args:[n],op:function(e,r){var n=t.resolveProperty(r,i.value);return n},evaluate:function(e){return t.unifiedEval(this,e)}};return e.parseElement("indirectExpression",r,a)}));t.addIndirectExpression("of",(function(e,t,r,n){if(!r.matchToken("of"))return;var i=e.requireElement("unaryExpression",r);var a=null;var o=n;while(o.root){a=o;o=o.root}if(o.type!=="symbol"&&o.type!=="attributeRef"&&o.type!=="styleRef"&&o.type!=="computedStyleRef"){e.raiseParseError(r,"Cannot take a property of a non-symbol: "+o.type)}var u=o.type==="attributeRef";var s=o.type==="styleRef"||o.type==="computedStyleRef";if(u||s){var l=o}var f=o.name;var c={type:"ofExpression",prop:o.token,root:i,attribute:l,expression:n,args:[i],op:function(e,r){if(u){return t.resolveAttribute(r,f)}else if(s){if(o.type==="computedStyleRef"){return t.resolveComputedStyle(r,f)}else{return t.resolveStyle(r,f)}}else{return t.resolveProperty(r,f)}},evaluate:function(e){return t.unifiedEval(this,e)}};if(o.type==="attributeRef"){c.attribute=o}if(a){a.root=c;a.args=[c]}else{n=c}return e.parseElement("indirectExpression",r,n)}));t.addIndirectExpression("possessive",(function(e,t,r,n){if(e.possessivesDisabled){return}var i=r.matchOpToken("'");if(i||n.type==="symbol"&&(n.name==="my"||n.name==="its"||n.name==="your")&&(r.currentToken().type==="IDENTIFIER"||r.currentToken().type==="ATTRIBUTE_REF"||r.currentToken().type==="STYLE_REF")){if(i){r.requireToken("s")}var a,o,u;a=e.parseElement("attributeRef",r);if(a==null){o=e.parseElement("styleRef",r);if(o==null){u=r.requireTokenType("IDENTIFIER")}}var s={type:"possessive",root:n,attribute:a||o,prop:u,args:[n],op:function(e,r){if(a){var n=t.resolveAttribute(r,a.name)}else if(o){var n;if(o.type==="computedStyleRef"){n=t.resolveComputedStyle(r,o["name"])}else{n=t.resolveStyle(r,o["name"])}}else{var n=t.resolveProperty(r,u.value)}return n},evaluate:function(e){return t.unifiedEval(this,e)}};return e.parseElement("indirectExpression",r,s)}}));t.addIndirectExpression("inExpression",(function(e,t,r,n){if(!r.matchToken("in"))return;var i=e.requireElement("unaryExpression",r);var a={type:"inExpression",root:n,args:[n,i],op:function(e,r,n){var i=[];if(r.css){t.implicitLoop(n,(function(e){var t=e.querySelectorAll(r.css);for(var n=0;n<t.length;n++){i.push(t[n])}}))}else if(r instanceof Element){var a=false;t.implicitLoop(n,(function(e){if(e.contains(r)){a=true}}));if(a){return r}}else{t.implicitLoop(r,(function(e){t.implicitLoop(n,(function(t){if(e===t){i.push(e)}}))}))}return i},evaluate:function(e){return t.unifiedEval(this,e)}};return e.parseElement("indirectExpression",r,a)}));t.addIndirectExpression("asExpression",(function(e,t,r,n){if(!r.matchToken("as"))return;r.matchToken("a")||r.matchToken("an");var i=e.requireElement("dotOrColonPath",r).evaluate();var a={type:"asExpression",root:n,args:[n],op:function(e,r){return t.convertValue(r,i)},evaluate:function(e){return t.unifiedEval(this,e)}};return e.parseElement("indirectExpression",r,a)}));t.addIndirectExpression("functionCall",(function(e,t,r,n){if(!r.matchOpToken("("))return;var i=[];if(!r.matchOpToken(")")){do{i.push(e.requireElement("expression",r))}while(r.matchOpToken(","));r.requireOpToken(")")}if(n.root){var a={type:"functionCall",root:n,argExressions:i,args:[n.root,i],op:function(e,r,i){t.nullCheck(r,n.root);var a=r[n.prop.value];t.nullCheck(a,n);if(a.hyperfunc){i.push(e)}return a.apply(r,i)},evaluate:function(e){return t.unifiedEval(this,e)}}}else{var a={type:"functionCall",root:n,argExressions:i,args:[n,i],op:function(e,r,i){t.nullCheck(r,n);if(r.hyperfunc){i.push(e)}var a=r.apply(null,i);return a},evaluate:function(e){return t.unifiedEval(this,e)}}}return e.parseElement("indirectExpression",r,a)}));t.addIndirectExpression("attributeRefAccess",(function(e,t,r,n){var i=e.parseElement("attributeRef",r);if(!i)return;var a={type:"attributeRefAccess",root:n,attribute:i,args:[n],op:function(e,r){var n=t.resolveAttribute(r,i.name);return n},evaluate:function(e){return t.unifiedEval(this,e)}};return a}));t.addIndirectExpression("arrayIndex",(function(e,t,r,n){if(!r.matchOpToken("["))return;var i=false;var a=false;var o=null;var u=null;if(r.matchOpToken("..")){i=true;o=e.requireElement("expression",r)}else{o=e.requireElement("expression",r);if(r.matchOpToken("..")){a=true;var s=r.currentToken();if(s.type!=="R_BRACKET"){u=e.parseElement("expression",r)}}}r.requireOpToken("]");var l={type:"arrayIndex",root:n,prop:o,firstIndex:o,secondIndex:u,args:[n,o,u],op:function(e,t,r,n){if(t==null){return null}if(i){if(r<0){r=t.length+r}return t.slice(0,r+1)}else if(a){if(n!=null){if(n<0){n=t.length+n}return t.slice(r,n+1)}else{return t.slice(r)}}else{return t[r]}},evaluate:function(e){return t.unifiedEval(this,e)}};return e.parseElement("indirectExpression",r,l)}));var a=["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","pc","pt","px"];t.addGrammarElement("postfixExpression",(function(e,t,r){var n=e.parseElement("primaryExpression",r);var i=r.matchAnyToken.apply(r,a)||r.matchOpToken("%");if(i){return{type:"stringPostfix",postfix:i.value,args:[n],op:function(e,t){return""+t+i.value},evaluate:function(e){return t.unifiedEval(this,e)}}}var o=null;if(r.matchToken("s")||r.matchToken("seconds")){o=1e3}else if(r.matchToken("ms")||r.matchToken("milliseconds")){o=1}if(o){return{type:"timeExpression",time:n,factor:o,args:[n],op:function(e,t){return t*o},evaluate:function(e){return t.unifiedEval(this,e)}}}if(r.matchOpToken(":")){var u=r.requireTokenType("IDENTIFIER");if(!u.value)return;var s=!r.matchOpToken("!");return{type:"typeCheck",typeName:u,nullOk:s,args:[n],op:function(e,r){var n=t.typeCheck(r,this.typeName.value,s);if(n){return r}else{throw new Error("Typecheck failed!  Expected: "+u.value)}},evaluate:function(e){return t.unifiedEval(this,e)}}}else{return n}}));t.addGrammarElement("logicalNot",(function(e,t,r){if(!r.matchToken("not"))return;var n=e.requireElement("unaryExpression",r);return{type:"logicalNot",root:n,args:[n],op:function(e,t){return!t},evaluate:function(e){return t.unifiedEval(this,e)}}}));t.addGrammarElement("noExpression",(function(e,t,r){if(!r.matchToken("no"))return;var n=e.requireElement("unaryExpression",r);return{type:"noExpression",root:n,args:[n],op:function(e,r){return t.isEmpty(r)},evaluate:function(e){return t.unifiedEval(this,e)}}}));t.addLeafExpression("some",(function(e,t,r){if(!r.matchToken("some"))return;var n=e.requireElement("expression",r);return{type:"noExpression",root:n,args:[n],op:function(e,r){return!t.isEmpty(r)},evaluate:function(e){return t.unifiedEval(this,e)}}}));t.addGrammarElement("negativeNumber",(function(e,t,r){if(!r.matchOpToken("-"))return;var n=e.requireElement("unaryExpression",r);return{type:"negativeNumber",root:n,args:[n],op:function(e,t){return-1*t},evaluate:function(e){return t.unifiedEval(this,e)}}}));t.addGrammarElement("unaryExpression",(function(e,t,r){r.matchToken("the");return e.parseAnyOf(["beepExpression","logicalNot","relativePositionalExpression","positionalExpression","noExpression","negativeNumber","postfixExpression"],r)}));t.addGrammarElement("beepExpression",(function(e,t,r){if(!r.matchToken("beep!"))return;var n=e.parseElement("unaryExpression",r);if(n){n["booped"]=true;var a=n.evaluate;n.evaluate=function(e){var r=a.apply(n,arguments);var o=e.me;if(t.triggerEvent(o,"hyperscript:beep",{element:o,expression:n,value:r})){var u;if(r){if(r instanceof s){u="ElementCollection"}else if(r.constructor){u=r.constructor.name}else{u="unknown"}}else{u="object (null)"}var l=r;if(u==="String"){l='"'+l+'"'}else if(r instanceof s){l=Array.from(r)}console.log("///_ BEEP! The expression ("+i.sourceFor.call(n).substr(6)+") evaluates to:",l,"of type "+u)}return r};return n}}));var u=function(e,t,r,n){var i=t.querySelectorAll(r);for(var a=0;a<i.length;a++){var o=i[a];if(o.compareDocumentPosition(e)===Node.DOCUMENT_POSITION_PRECEDING){return o}}if(n){return i[0]}};var l=function(e,t,r,n){var i=t.querySelectorAll(r);for(var a=i.length-1;a>=0;a--){var o=i[a];if(o.compareDocumentPosition(e)===Node.DOCUMENT_POSITION_FOLLOWING){return o}}if(n){return i[i.length-1]}};var c=function(e,t,r,n){var i=[];o.prototype.forEach(t,(function(t){if(t.matches(r)||t===e){i.push(t)}}));for(var a=0;a<i.length-1;a++){var u=i[a];if(u===e){return i[a+1]}}if(n){var s=i[0];if(s&&s.matches(r)){return s}}};var p=function(e,t,r,n){return c(e,Array.from(t).reverse(),r,n)};t.addGrammarElement("relativePositionalExpression",(function(e,t,r){var n=r.matchAnyToken("next","previous");if(!n)return;var i=n.value==="next";var a=e.parseElement("expression",r);if(r.matchToken("from")){r.pushFollow("in");try{var o=e.requireElement("unaryExpression",r)}finally{r.popFollow()}}else{var o=e.requireElement("implicitMeTarget",r)}var s=false;var f;if(r.matchToken("in")){s=true;var m=e.requireElement("unaryExpression",r)}else if(r.matchToken("within")){f=e.requireElement("unaryExpression",r)}else{f=document.body}var v=false;if(r.matchToken("with")){r.requireToken("wrapping");v=true}return{type:"relativePositionalExpression",from:o,forwardSearch:i,inSearch:s,wrapping:v,inElt:m,withinElt:f,operator:n.value,args:[a,o,m,f],op:function(e,t,r,n,a){var o=t.css;if(o==null){throw"Expected a CSS value"}if(s){if(n){if(i){return c(r,n,o,v)}else{return p(r,n,o,v)}}}else{if(a){if(i){return u(r,a,o,v)}else{return l(r,a,o,v)}}}},evaluate:function(e){return t.unifiedEval(this,e)}}}));t.addGrammarElement("positionalExpression",(function(e,t,r){var n=r.matchAnyToken("first","last","random");if(!n)return;r.matchAnyToken("in","from","of");var i=e.requireElement("unaryExpression",r);var a=n.value;return{type:"positionalExpression",rhs:i,operator:n.value,args:[i],op:function(e,t){if(t&&!Array.isArray(t)){if(t.children){t=t.children}else{t=Array.from(t)}}if(t){if(a==="first"){return t[0]}else if(a==="last"){return t[t.length-1]}else if(a==="random"){return t[Math.floor(Math.random()*t.length)]}}},evaluate:function(e){return t.unifiedEval(this,e)}}}));t.addGrammarElement("mathOperator",(function(e,t,r){var n=e.parseElement("unaryExpression",r);var i,a=null;i=r.matchAnyOpToken("+","-","*","/","%");while(i){a=a||i;var o=i.value;if(a.value!==o){e.raiseParseError(r,"You must parenthesize math operations with different operators")}var u=e.parseElement("unaryExpression",r);n={type:"mathOperator",lhs:n,rhs:u,operator:o,args:[n,u],op:function(e,t,r){if(o==="+"){return t+r}else if(o==="-"){return t-r}else if(o==="*"){return t*r}else if(o==="/"){return t/r}else if(o==="%"){return t%r}},evaluate:function(e){return t.unifiedEval(this,e)}};i=r.matchAnyOpToken("+","-","*","/","%")}return n}));t.addGrammarElement("mathExpression",(function(e,t,r){return e.parseAnyOf(["mathOperator","unaryExpression"],r)}));function v(e,t,r){if(t["contains"]){return t.contains(r)}else if(t["includes"]){return t.includes(r)}else{throw Error("The value of "+e.sourceFor()+" does not have a contains or includes method on it")}}function h(e,t,r){if(t["match"]){return!!t.match(r)}else if(t["matches"]){return t.matches(r)}else{throw Error("The value of "+e.sourceFor()+" does not have a match or matches method on it")}}t.addGrammarElement("comparisonOperator",(function(e,t,r){var n=e.parseElement("mathExpression",r);var i=r.matchAnyOpToken("<",">","<=",">=","==","===","!=","!==");var a=i?i.value:null;var o=true;var u=false;if(a==null){if(r.matchToken("is")||r.matchToken("am")){if(r.matchToken("not")){if(r.matchToken("in")){a="not in"}else if(r.matchToken("a")){a="not a";u=true}else if(r.matchToken("empty")){a="not empty";o=false}else{a="!="}}else if(r.matchToken("in")){a="in"}else if(r.matchToken("a")){a="a";u=true}else if(r.matchToken("empty")){a="empty";o=false}else if(r.matchToken("less")){r.requireToken("than");if(r.matchToken("or")){r.requireToken("equal");r.requireToken("to");a="<="}else{a="<"}}else if(r.matchToken("greater")){r.requireToken("than");if(r.matchToken("or")){r.requireToken("equal");r.requireToken("to");a=">="}else{a=">"}}else{a="=="}}else if(r.matchToken("exist")||r.matchToken("exists")){a="exist";o=false}else if(r.matchToken("matches")||r.matchToken("match")){a="match"}else if(r.matchToken("contains")||r.matchToken("contain")){a="contain"}else if(r.matchToken("includes")||r.matchToken("include")){a="include"}else if(r.matchToken("do")||r.matchToken("does")){r.requireToken("not");if(r.matchToken("matches")||r.matchToken("match")){a="not match"}else if(r.matchToken("contains")||r.matchToken("contain")){a="not contain"}else if(r.matchToken("exist")||r.matchToken("exist")){a="not exist";o=false}else if(r.matchToken("include")){a="not include"}else{e.raiseParseError(r,"Expected matches or contains")}}}if(a){var s,l,f;if(u){s=r.requireTokenType("IDENTIFIER");l=!r.matchOpToken("!")}else if(o){f=e.requireElement("mathExpression",r);if(a==="match"||a==="not match"){f=f.css?f.css:f}}var c=n;n={type:"comparisonOperator",operator:a,typeName:s,nullOk:l,lhs:n,rhs:f,args:[n,f],op:function(e,r,n){if(a==="=="){return r==n}else if(a==="!="){return r!=n}if(a==="match"){return r!=null&&h(c,r,n)}if(a==="not match"){return r==null||!h(c,r,n)}if(a==="in"){return n!=null&&v(f,n,r)}if(a==="not in"){return n==null||!v(f,n,r)}if(a==="contain"){return r!=null&&v(c,r,n)}if(a==="not contain"){return r==null||!v(c,r,n)}if(a==="include"){return r!=null&&v(c,r,n)}if(a==="not include"){return r==null||!v(c,r,n)}if(a==="==="){return r===n}else if(a==="!=="){return r!==n}else if(a==="<"){return r<n}else if(a===">"){return r>n}else if(a==="<="){return r<=n}else if(a===">="){return r>=n}else if(a==="empty"){return t.isEmpty(r)}else if(a==="not empty"){return!t.isEmpty(r)}else if(a==="exist"){return t.doesExist(r)}else if(a==="not exist"){return!t.doesExist(r)}else if(a==="a"){return t.typeCheck(r,s.value,l)}else if(a==="not a"){return!t.typeCheck(r,s.value,l)}else{throw"Unknown comparison : "+a}},evaluate:function(e){return t.unifiedEval(this,e)}}}return n}));t.addGrammarElement("comparisonExpression",(function(e,t,r){return e.parseAnyOf(["comparisonOperator","mathExpression"],r)}));t.addGrammarElement("logicalOperator",(function(e,t,r){var n=e.parseElement("comparisonExpression",r);var i,a=null;i=r.matchToken("and")||r.matchToken("or");var o=function(){a=a||i;if(a.value!==i.value){e.raiseParseError(r,"You must parenthesize logical operations with different operators")}u=e.requireElement("comparisonExpression",r);var o=i.value;n={type:"logicalOperator",operator:o,lhs:n,rhs:u,args:[n,u],op:function(e,t,r){if(o==="and"){return t&&r}else{return t||r}},evaluate:function(e){return t.unifiedEval(this,e)}};i=r.matchToken("and")||r.matchToken("or")};var u;while(i){o()}return n}));t.addGrammarElement("logicalExpression",(function(e,t,r){return e.parseAnyOf(["logicalOperator","mathExpression"],r)}));t.addGrammarElement("asyncExpression",(function(e,t,r){if(r.matchToken("async")){var n=e.requireElement("logicalExpression",r);var i={type:"asyncExpression",value:n,evaluate:function(e){return{asyncWrapper:true,value:this.value.evaluate(e)}}};return i}else{return e.parseElement("logicalExpression",r)}}));t.addGrammarElement("expression",(function(e,t,r){r.matchToken("the");return e.parseElement("asyncExpression",r)}));t.addGrammarElement("assignableExpression",(function(e,t,r){r.matchToken("the");var n=e.parseElement("primaryExpression",r);if(n&&(n.type==="symbol"||n.type==="ofExpression"||n.type==="propertyAccess"||n.type==="attributeRefAccess"||n.type==="attributeRef"||n.type==="styleRef"||n.type==="arrayIndex"||n.type==="possessive")){return n}else{e.raiseParseError(r,"A target expression must be writable.  The expression type '"+(n&&n.type)+"' is not.")}return n}));t.addGrammarElement("hyperscript",(function(e,t,r){var n=[];if(r.hasMore()){while(e.featureStart(r.currentToken())||r.currentToken().value==="("){var i=e.requireElement("feature",r);n.push(i);r.matchToken("end")}}return{type:"hyperscript",features:n,apply:function(e,t,r){var i,a;try{for(var o=__values(n),u=o.next();!u.done;u=o.next()){var s=u.value;s.install(e,t,r)}}catch(e){i={error:e}}finally{try{if(u&&!u.done&&(a=o.return))a.call(o)}finally{if(i)throw i.error}}}}}));var d=function(e){var t=[];if(e.token(0).value==="("&&(e.token(1).value===")"||e.token(2).value===","||e.token(2).value===")")){e.matchOpToken("(");do{t.push(e.requireTokenType("IDENTIFIER"))}while(e.matchOpToken(","));e.requireOpToken(")")}return t};t.addFeature("on",(function(e,t,r){if(!r.matchToken("on"))return;var n=false;if(r.matchToken("every")){n=true}var i=[];var a=null;do{var o=e.requireElement("eventName",r,"Expected event name");var u=o.evaluate();if(a){a=a+" or "+u}else{a="on "+u}var s=d(r);var l=null;if(r.matchOpToken("[")){l=e.requireElement("expression",r);r.requireOpToken("]")}var f,c,p;if(r.currentToken().type==="NUMBER"){var m=r.consumeToken();if(!m.value)return;f=parseInt(m.value);if(r.matchToken("to")){var v=r.consumeToken();if(!v.value)return;c=parseInt(v.value)}else if(r.matchToken("and")){p=true;r.requireToken("on")}}var h,y;if(u==="intersection"){h={};if(r.matchToken("with")){h["with"]=e.requireElement("expression",r).evaluate()}if(r.matchToken("having")){do{if(r.matchToken("margin")){h["rootMargin"]=e.requireElement("stringLike",r).evaluate()}else if(r.matchToken("threshold")){h["threshold"]=e.requireElement("expression",r).evaluate()}else{e.raiseParseError(r,"Unknown intersection config specification")}}while(r.matchToken("and"))}}else if(u==="mutation"){y={};if(r.matchToken("of")){do{if(r.matchToken("anything")){y["attributes"]=true;y["subtree"]=true;y["characterData"]=true;y["childList"]=true}else if(r.matchToken("childList")){y["childList"]=true}else if(r.matchToken("attributes")){y["attributes"]=true;y["attributeOldValue"]=true}else if(r.matchToken("subtree")){y["subtree"]=true}else if(r.matchToken("characterData")){y["characterData"]=true;y["characterDataOldValue"]=true}else if(r.currentToken().type==="ATTRIBUTE_REF"){var E=r.consumeToken();if(y["attributeFilter"]==null){y["attributeFilter"]=[]}if(E.value.indexOf("@")==0){y["attributeFilter"].push(E.value.substring(1))}else{e.raiseParseError(r,"Only shorthand attribute references are allowed here")}}else{e.raiseParseError(r,"Unknown mutation config specification")}}while(r.matchToken("or"))}else{y["attributes"]=true;y["characterData"]=true;y["childList"]=true}}var T=null;var k=false;if(r.matchToken("from")){if(r.matchToken("elsewhere")){k=true}else{T=e.parseElement("expression",r);if(!T){e.raiseParseError(r,'Expected either target value or "elsewhere".')}}}if(T===null&&k===false&&r.matchToken("elsewhere")){k=true}if(r.matchToken("in")){var x=e.parseElement("unaryExpression",r)}if(r.matchToken("debounced")){r.requireToken("at");var g=e.requireElement("expression",r);var b=g.evaluate({})}else if(r.matchToken("throttled")){r.requireToken("at");var g=e.requireElement("expression",r);var w=g.evaluate({})}i.push({execCount:0,every:n,on:u,args:s,filter:l,from:T,inExpr:x,elsewhere:k,startCount:f,endCount:c,unbounded:p,debounceTime:b,throttleTime:w,mutationSpec:y,intersectionSpec:h,debounced:undefined,lastExec:undefined})}while(r.matchToken("or"));var S=true;if(!n){if(r.matchToken("queue")){if(r.matchToken("all")){var q=true;var S=false}else if(r.matchToken("first")){var N=true}else if(r.matchToken("none")){var I=true}else{r.requireToken("last")}}}var R=e.requireElement("commandList",r);e.ensureTerminated(R);var C,A;if(r.matchToken("catch")){C=r.requireTokenType("IDENTIFIER").value;A=e.requireElement("commandList",r);e.ensureTerminated(A)}if(r.matchToken("finally")){var O=e.requireElement("commandList",r);e.ensureTerminated(O)}var L={displayName:a,events:i,start:R,every:n,execCount:0,errorHandler:A,errorSymbol:C,execute:function(e){var r=t.getEventQueueFor(e.me,L);if(r.executing&&n===false){if(I||N&&r.queue.length>0){return}if(S){r.queue.length=0}r.queue.push(e);return}L.execCount++;r.executing=true;e.meta.onHalt=function(){r.executing=false;var e=r.queue.shift();if(e){setTimeout((function(){L.execute(e)}),1)}};e.meta.reject=function(r){console.error(r.message?r.message:r);var n=t.getHyperTrace(e,r);if(n){n.print()}t.triggerEvent(e.me,"exception",{error:r})};R.execute(e)},install:function(e,r){var n,i;var o=function(r){if(r.elsewhere){u=[document]}else if(r.from){u=r.from.evaluate(t.makeContext(e,L,e,null))}else{u=[e]}t.implicitLoop(u,(function(n){var i=r.on;if(n==null){console.warn("'%s' feature ignored because target does not exists:",a,e);return}if(r.mutationSpec){i="hyperscript:mutation";var o=new MutationObserver((function(e,r){if(!L.executing){t.triggerEvent(n,i,{mutationList:e,observer:r})}}));o.observe(n,r.mutationSpec)}if(r.intersectionSpec){i="hyperscript:insersection";var u=new IntersectionObserver((function(e){var r,a;try{for(var o=__values(e),s=o.next();!s.done;s=o.next()){var l=s.value;var f={observer:u};f=Object.assign(f,l);f["intersecting"]=l.isIntersecting;t.triggerEvent(n,i,f)}}catch(e){r={error:e}}finally{try{if(s&&!s.done&&(a=o.return))a.call(o)}finally{if(r)throw r.error}}}),r.intersectionSpec);u.observe(n)}var s=n.addEventListener||n.on;s.call(n,i,(function a(o){var u,s;if(typeof Node!=="undefined"&&e instanceof Node&&n!==e&&!e.isConnected){n.removeEventListener(i,a);return}var l=t.makeContext(e,L,e,o);if(r.elsewhere&&e.contains(o.target)){return}if(r.from){l.result=n}try{for(var f=__values(r.args),c=f.next();!c.done;c=f.next()){var p=c.value;var m=l.event[p.value];if(m!==undefined){l.locals[p.value]=m}else if("detail"in l.event){l.locals[p.value]=l.event["detail"][p.value]}}}catch(e){u={error:e}}finally{try{if(c&&!c.done&&(s=f.return))s.call(f)}finally{if(u)throw u.error}}l.meta.errorHandler=A;l.meta.errorSymbol=C;l.meta.finallyHandler=O;if(r.filter){var v=l.meta.context;l.meta.context=l.event;try{var h=r.filter.evaluate(l);if(h){}else{return}}finally{l.meta.context=v}}if(r.inExpr){var d=o.target;while(true){if(d.matches&&d.matches(r.inExpr.css)){l.result=d;break}else{d=d.parentElement;if(d==null){return}}}}r.execCount++;if(r.startCount){if(r.endCount){if(r.execCount<r.startCount||r.execCount>r.endCount){return}}else if(r.unbounded){if(r.execCount<r.startCount){return}}else if(r.execCount!==r.startCount){return}}if(r.debounceTime){if(r.debounced){clearTimeout(r.debounced)}r.debounced=setTimeout((function(){L.execute(l)}),r.debounceTime);return}if(r.throttleTime){if(r.lastExec&&Date.now()<r.lastExec+r.throttleTime){return}else{r.lastExec=Date.now()}}L.execute(l)}))}))};var u;try{for(var s=__values(L.events),l=s.next();!l.done;l=s.next()){var f=l.value;o(f)}}catch(e){n={error:e}}finally{try{if(l&&!l.done&&(i=s.return))i.call(s)}finally{if(n)throw n.error}}},executing:undefined};e.setParent(R,L);return L}));t.addFeature("def",(function(e,t,r){if(!r.matchToken("def"))return;var n=e.requireElement("dotOrColonPath",r);var i=n.evaluate();var a=i.split(".");var o=a.pop();var u=[];if(r.matchOpToken("(")){if(r.matchOpToken(")")){}else{do{u.push(r.requireTokenType("IDENTIFIER"))}while(r.matchOpToken(","));r.requireOpToken(")")}}var s=e.requireElement("commandList",r);var l,f;if(r.matchToken("catch")){l=r.requireTokenType("IDENTIFIER").value;f=e.parseElement("commandList",r)}if(r.matchToken("finally")){var c=e.requireElement("commandList",r);e.ensureTerminated(c)}var p={displayName:o+"("+u.map((function(e){return e.value})).join(", ")+")",name:o,args:u,start:s,errorHandler:f,errorSymbol:l,finallyHandler:c,install:function(e,r){var n=function(){var n=t.makeContext(r,p,e,null);n.meta.errorHandler=f;n.meta.errorSymbol=l;n.meta.finallyHandler=c;for(var i=0;i<u.length;i++){var a=u[i];var o=arguments[i];if(a){n.locals[a.value]=o}}n.meta.caller=arguments[u.length];if(n.meta.caller){n.meta.callingCommand=n.meta.caller.meta.command}var m,v=null;var h=new Promise((function(e,t){m=e;v=t}));s.execute(n);if(n.meta.returned){return n.meta.returnValue}else{n.meta.resolve=m;n.meta.reject=v;return h}};n["hyperfunc"]=true;n["hypername"]=i;t.assignToNamespace(e,a,o,n)}};e.ensureTerminated(s);if(f){e.ensureTerminated(f)}e.setParent(s,p);return p}));t.addFeature("set",(function(e,t,r){var n=e.parseElement("setCommand",r);if(n){if(n.target.scope!=="element"){e.raiseParseError(r,"variables declared at the feature level must be element scoped.")}var i={start:n,install:function(e,r){n&&n.execute(t.makeContext(e,i,e,null))}};e.ensureTerminated(n);return i}}));t.addFeature("init",(function(e,t,r){if(!r.matchToken("init"))return;var n=r.matchToken("immediately");var i=e.requireElement("commandList",r);var a={start:i,install:function(e,r){var o=function(){i&&i.execute(t.makeContext(e,a,e,null))};if(n){o()}else{setTimeout(o,0)}}};e.ensureTerminated(i);e.setParent(i,a);return a}));t.addFeature("worker",(function(e,t,r){if(r.matchToken("worker")){e.raiseParseError(r,"In order to use the 'worker' feature, include "+"the _hyperscript worker plugin. See "+"https://hyperscript.org/features/worker/ for "+"more info.");return undefined}}));t.addFeature("behavior",(function(t,r,n){if(!n.matchToken("behavior"))return;var i=t.requireElement("dotOrColonPath",n).evaluate();var a=i.split(".");var o=a.pop();var u=[];if(n.matchOpToken("(")&&!n.matchOpToken(")")){do{u.push(n.requireTokenType("IDENTIFIER").value)}while(n.matchOpToken(","));n.requireOpToken(")")}var s=t.requireElement("hyperscript",n);for(var l=0;l<s.features.length;l++){var c=s.features[l];c.behavior=i}return{install:function(t,n){r.assignToNamespace(e.document&&e.document.body,a,o,(function(e,t,n){var a=r.getInternalData(e);var o=f(a,i+"Scope");for(var l=0;l<u.length;l++){o[u[l]]=n[u[l]]}s.apply(e,t)}))}}}));t.addFeature("install",(function(t,r,n){if(!n.matchToken("install"))return;var i=t.requireElement("dotOrColonPath",n).evaluate();var a=i.split(".");var o=t.parseElement("namedArgumentList",n);var u;return u={install:function(t,n){r.unifiedEval({args:[o],op:function(r,o){var u=e;for(var s=0;s<a.length;s++){u=u[a[s]];if(typeof u!=="object"&&typeof u!=="function")throw new Error("No such behavior defined as "+i)}if(!(u instanceof Function))throw new Error(i+" is not a behavior");u(t,n,o)}},r.makeContext(t,u,t,null))}}}));t.addGrammarElement("jsBody",(function(e,t,r){var n=r.currentToken().start;var i=r.currentToken();var a=[];var o="";var u=false;while(r.hasMore()){i=r.consumeToken();var s=r.token(0,true);if(s.type==="IDENTIFIER"&&s.value==="end"){break}if(u){if(i.type==="IDENTIFIER"||i.type==="NUMBER"){o+=i.value}else{if(o!=="")a.push(o);o="";u=false}}else if(i.type==="IDENTIFIER"&&i.value==="function"){u=true}}var l=i.end+1;return{type:"jsBody",exposedFunctionNames:a,jsSource:r.source.substring(n,l)}}));t.addFeature("js",(function(t,r,n){if(!n.matchToken("js"))return;var i=t.requireElement("jsBody",n);var a=i.jsSource+"\nreturn { "+i.exposedFunctionNames.map((function(e){return e+":"+e})).join(",")+" } ";var o=new Function(a);return{jsSource:a,function:o,exposedFunctionNames:i.exposedFunctionNames,install:function(){Object.assign(e,o())}}}));t.addCommand("js",(function(t,r,n){if(!n.matchToken("js"))return;var i=[];if(n.matchOpToken("(")){if(n.matchOpToken(")")){}else{do{var a=n.requireTokenType("IDENTIFIER");i.push(a.value)}while(n.matchOpToken(","));n.requireOpToken(")")}}var o=t.requireElement("jsBody",n);n.matchToken("end");var u=m(Function,i.concat([o.jsSource]));var s={jsSource:o.jsSource,function:u,inputs:i,op:function(t){var n=[];i.forEach((function(e){n.push(r.resolveSymbol(e,t,"default"))}));var a=u.apply(e,n);if(a&&typeof a.then==="function"){return new Promise((function(e){a.then((function(n){t.result=n;e(r.findNext(this,t))}))}))}else{t.result=a;return r.findNext(this,t)}}};return s}));t.addCommand("async",(function(e,t,r){if(!r.matchToken("async"))return;if(r.matchToken("do")){var n=e.requireElement("commandList",r);var i=n;while(i.next)i=i.next;i.next=t.HALT;r.requireToken("end")}else{var n=e.requireElement("command",r)}var a={body:n,op:function(e){setTimeout((function(){n.execute(e)}));return t.findNext(this,e)}};e.setParent(n,a);return a}));t.addCommand("tell",(function(e,t,r){var n=r.currentToken();if(!r.matchToken("tell"))return;var i=e.requireElement("expression",r);var a=e.requireElement("commandList",r);if(r.hasMore()&&!e.featureStart(r.currentToken())){r.requireToken("end")}var o="tell_"+n.start;var u={value:i,body:a,args:[i],resolveNext:function(e){var r=e.meta.iterators[o];if(r.index<r.value.length){e.you=r.value[r.index++];return a}else{e.you=r.originalYou;if(this.next){return this.next}else{return t.findNext(this.parent,e)}}},op:function(e,t){if(t==null){t=[]}else if(!(Array.isArray(t)||t instanceof NodeList)){t=[t]}e.meta.iterators[o]={originalYou:e.you,index:0,value:t};return this.resolveNext(e)}};e.setParent(a,u);return u}));t.addCommand("wait",(function(e,t,r){if(!r.matchToken("wait"))return;var n;if(r.matchToken("for")){r.matchToken("a");var i=[];do{var a=r.token(0);if(a.type==="NUMBER"||a.type==="L_PAREN"){i.push({time:e.requireElement("expression",r).evaluate()})}else{i.push({name:e.requireElement("dotOrColonPath",r,"Expected event name").evaluate(),args:d(r)})}}while(r.matchToken("or"));if(r.matchToken("from")){var o=e.requireElement("expression",r)}n={event:i,on:o,args:[o],op:function(e,r){var n=this;var a=r?r:e.me;if(!(a instanceof EventTarget))throw new Error("Not a valid event target: "+this.on.sourceFor());return new Promise((function(r){var o,u;var s=false;var l=function(i){f=function(a){var o,u;e.result=a;if(i.args){try{for(var l=(o=void 0,__values(i.args)),f=l.next();!f.done;f=l.next()){var c=f.value;e.locals[c.value]=a[c.value]||(a.detail?a.detail[c.value]:null)}}catch(e){o={error:e}}finally{try{if(f&&!f.done&&(u=l.return))u.call(l)}finally{if(o)throw o.error}}}if(!s){s=true;r(t.findNext(n,e))}};if(i.name){a.addEventListener(i.name,f,{once:true})}else if(i.time!=null){setTimeout(f,i.time,i.time)}};var f;try{for(var c=__values(i),p=c.next();!p.done;p=c.next()){var m=p.value;l(m)}}catch(e){o={error:e}}finally{try{if(p&&!p.done&&(u=c.return))u.call(c)}finally{if(o)throw o.error}}}))}};return n}else{var u;if(r.matchToken("a")){r.requireToken("tick");u=0}else{u=e.requireElement("expression",r)}n={type:"waitCmd",time:u,args:[u],op:function(e,r){var n=this;return new Promise((function(i){setTimeout((function(){i(t.findNext(n,e))}),r)}))},execute:function(e){return t.unifiedExec(this,e)}};return n}}));t.addGrammarElement("dotOrColonPath",(function(e,t,r){var n=r.matchTokenType("IDENTIFIER");if(n){var i=[n.value];var a=r.matchOpToken(".")||r.matchOpToken(":");if(a){do{i.push(r.requireTokenType("IDENTIFIER","NUMBER").value)}while(r.matchOpToken(a.value))}return{type:"dotOrColonPath",path:i,evaluate:function(){return i.join(a?a.value:"")}}}}));t.addGrammarElement("eventName",(function(e,t,r){var n;if(n=r.matchTokenType("STRING")){return{evaluate:function(){return n.value}}}return e.parseElement("dotOrColonPath",r)}));function y(e,t,r,n){var i=t.requireElement("eventName",n);var a=t.parseElement("namedArgumentList",n);if(e==="send"&&n.matchToken("to")||e==="trigger"&&n.matchToken("on")){var o=t.requireElement("expression",n)}else{var o=t.requireElement("implicitMeTarget",n)}var u={eventName:i,details:a,to:o,args:[o,i,a],op:function(e,t,n,i){r.nullCheck(t,o);r.forEach(t,(function(t){r.triggerEvent(t,n,i,e.me)}));return r.findNext(u,e)}};return u}t.addCommand("trigger",(function(e,t,r){if(r.matchToken("trigger")){return y("trigger",e,t,r)}}));t.addCommand("send",(function(e,t,r){if(r.matchToken("send")){return y("send",e,t,r)}}));var E=function(e,t,r,n){if(n){if(e.commandBoundary(r.currentToken())){e.raiseParseError(r,"'return' commands must return a value.  If you do not wish to return a value, use 'exit' instead.")}else{var i=e.requireElement("expression",r)}}var a={value:i,args:[i],op:function(e,r){var n=e.meta.resolve;e.meta.returned=true;e.meta.returnValue=r;if(n){if(r){n(r)}else{n()}}return t.HALT}};return a};t.addCommand("return",(function(e,t,r){if(r.matchToken("return")){return E(e,t,r,true)}}));t.addCommand("exit",(function(e,t,r){if(r.matchToken("exit")){return E(e,t,r,false)}}));t.addCommand("halt",(function(e,t,r){if(r.matchToken("halt")){if(r.matchToken("the")){r.requireToken("event");if(r.matchOpToken("'")){r.requireToken("s")}var n=true}if(r.matchToken("bubbling")){var i=true}else if(r.matchToken("default")){var a=true}var o=E(e,t,r,false);var u={keepExecuting:true,bubbling:i,haltDefault:a,exit:o,op:function(e){if(e.event){if(i){e.event.stopPropagation()}else if(a){e.event.preventDefault()}else{e.event.stopPropagation();e.event.preventDefault()}if(n){return t.findNext(this,e)}else{return o}}}};return u}}));t.addCommand("log",(function(e,t,r){if(!r.matchToken("log"))return;var n=[e.parseElement("expression",r)];while(r.matchOpToken(",")){n.push(e.requireElement("expression",r))}if(r.matchToken("with")){var i=e.requireElement("expression",r)}var a={exprs:n,withExpr:i,args:[i,n],op:function(e,r,n){if(r){r.apply(null,n)}else{console.log.apply(null,n)}return t.findNext(this,e)}};return a}));t.addCommand("throw",(function(e,t,r){if(!r.matchToken("throw"))return;var n=e.requireElement("expression",r);var i={expr:n,args:[n],op:function(e,r){t.registerHyperTrace(e,r);throw r}};return i}));var T=function(e,t,r){var n=e.requireElement("expression",r);var i={expr:n,args:[n],op:function(e,r){e.result=r;return t.findNext(i,e)}};return i};t.addCommand("call",(function(e,t,r){if(!r.matchToken("call"))return;var n=T(e,t,r);if(n.expr&&n.expr.type!=="functionCall"){e.raiseParseError(r,"Must be a function invocation")}return n}));t.addCommand("get",(function(e,t,r){if(r.matchToken("get")){return T(e,t,r)}}));t.addCommand("make",(function(e,t,r){if(!r.matchToken("make"))return;r.matchToken("a")||r.matchToken("an");var n=e.requireElement("expression",r);var i=[];if(n.type!=="queryRef"&&r.matchToken("from")){do{i.push(e.requireElement("expression",r))}while(r.matchOpToken(","))}if(r.matchToken("called")){var a=e.requireElement("symbol",r)}var o;if(n.type==="queryRef"){o={op:function(e){var r,i="div",o,u=[];var s=/(?:(^|#|\.)([^#\. ]+))/g;while(r=s.exec(n.css)){if(r[1]==="")i=r[2].trim();else if(r[1]==="#")o=r[2].trim();else u.push(r[2].trim())}var l=document.createElement(i);if(o!==undefined)l.id=o;for(var f=0;f<u.length;f++){var c=u[f];l.classList.add(c)}e.result=l;if(a){t.setSymbol(a.name,e,a.scope,l)}return t.findNext(this,e)}};return o}else{o={args:[n,i],op:function(e,r,n){e.result=m(r,n);if(a){t.setSymbol(a.name,e,a.scope,e.result)}return t.findNext(this,e)}};return o}}));t.addGrammarElement("pseudoCommand",(function(e,t,r){var n=r.token(1);if(!(n&&n.op&&(n.value==="."||n.value==="("))){return null}var i=e.requireElement("primaryExpression",r);var a=i.root;var o=i;while(a.root!=null){o=o.root;a=a.root}if(i.type!=="functionCall"){e.raiseParseError(r,"Pseudo-commands must be function calls")}if(o.type==="functionCall"&&o.root.root==null){if(r.matchAnyToken("the","to","on","with","into","from","at")){var u=e.requireElement("expression",r)}else if(r.matchToken("me")){var u=e.requireElement("implicitMeTarget",r)}}var s;if(u){s={type:"pseudoCommand",root:u,argExressions:o.argExressions,args:[u,o.argExressions],op:function(e,r,n){t.nullCheck(r,u);var i=r[o.root.name];t.nullCheck(i,o);if(i.hyperfunc){n.push(e)}e.result=i.apply(r,n);return t.findNext(s,e)},execute:function(e){return t.unifiedExec(this,e)}}}else{s={type:"pseudoCommand",expr:i,args:[i],op:function(e,r){e.result=r;return t.findNext(s,e)},execute:function(e){return t.unifiedExec(this,e)}}}return s}));var k=function(e,t,r,n,i){var a=n.type==="symbol";var o=n.type==="attributeRef";var u=n.type==="styleRef";var s=n.type==="arrayIndex";if(!(o||u||a)&&n.root==null){e.raiseParseError(r,"Can only put directly into symbols, not references")}var l=null;var f=null;if(a){}else if(o||u){l=e.requireElement("implicitMeTarget",r);var c=n}else if(s){f=n.firstIndex;l=n.root}else{f=n.prop?n.prop.value:null;var c=n.attribute;l=n.root}var p={target:n,symbolWrite:a,value:i,args:[l,f,i],op:function(e,r,i,o){if(a){t.setSymbol(n.name,e,n.scope,o)}else{t.nullCheck(r,l);if(s){r[i]=o}else{t.implicitLoop(r,(function(e){if(c){if(c.type==="attributeRef"){if(o==null){e.removeAttribute(c.name)}else{e.setAttribute(c.name,o)}}else{e.style[c.name]=o}}else{e[i]=o}}))}}return t.findNext(this,e)},parent:undefined};return p};t.addCommand("default",(function(e,t,r){if(!r.matchToken("default"))return;var n=e.requireElement("assignableExpression",r);r.requireToken("to");var i=e.requireElement("expression",r);var a=k(e,t,r,n,i);var o={target:n,value:i,setter:a,args:[n],op:function(e,r){if(r){return t.findNext(this,e)}else{return a}}};a.parent=o;return o}));t.addCommand("set",(function(e,t,r){if(!r.matchToken("set"))return;if(r.currentToken().type==="L_BRACE"){var n=e.requireElement("objectLiteral",r);r.requireToken("on");var i=e.requireElement("expression",r);var a={objectLiteral:n,target:i,args:[n,i],op:function(e,r,n){Object.assign(n,r);return t.findNext(this,e)}};return a}try{r.pushFollow("to");var i=e.requireElement("assignableExpression",r)}finally{r.popFollow()}r.requireToken("to");var o=e.requireElement("expression",r);return k(e,t,r,i,o)}));t.addCommand("if",(function(e,t,r){if(!r.matchToken("if"))return;var n=e.requireElement("expression",r);r.matchToken("then");var i=e.parseElement("commandList",r);if(r.matchToken("else")||r.matchToken("otherwise")){var a=e.parseElement("commandList",r)}if(r.hasMore()){r.requireToken("end")}var o={expr:n,trueBranch:i,falseBranch:a,args:[n],op:function(e,r){if(r){return i}else if(a){return a}else{return t.findNext(this,e)}}};e.setParent(i,o);e.setParent(a,o);return o}));var x=function(e,t,r,n){var i=t.currentToken();var a;if(t.matchToken("for")||n){var o=t.requireTokenType("IDENTIFIER");a=o.value;t.requireToken("in");var u=e.requireElement("expression",t)}else if(t.matchToken("in")){a="it";var u=e.requireElement("expression",t)}else if(t.matchToken("while")){var s=e.requireElement("expression",t)}else if(t.matchToken("until")){var l=true;if(t.matchToken("event")){var f=e.requireElement("dotOrColonPath",t,"Expected event name");if(t.matchToken("from")){var c=e.requireElement("expression",t)}}else{var s=e.requireElement("expression",t)}}else{if(!e.commandBoundary(t.currentToken())&&t.currentToken().value!=="forever"){var p=e.requireElement("expression",t);t.requireToken("times")}else{t.matchToken("forever");var m=true}}if(t.matchToken("index")){var o=t.requireTokenType("IDENTIFIER");var v=o.value}var h=e.parseElement("commandList",t);if(h&&f){var d=h;while(d.next){d=d.next}var y={type:"waitATick",op:function(){return new Promise((function(e){setTimeout((function(){e(r.findNext(y))}),0)}))}};d.next=y}if(t.hasMore()){t.requireToken("end")}if(a==null){a="_implicit_repeat_"+i.start;var E=a}else{var E=a+"_"+i.start}var T={identifier:a,indexIdentifier:v,slot:E,expression:u,forever:m,times:p,until:l,event:f,on:c,whileExpr:s,resolveNext:function(){return this},loop:h,args:[s,p],op:function(e,t,n){var i=e.meta.iterators[E];var o=false;var u=null;if(this.forever){o=true}else if(this.until){if(f){o=e.meta.iterators[E].eventFired===false}else{o=t!==true}}else if(s){o=t}else if(n){o=i.index<n}else{var l=i.iterator.next();o=!l.done;u=l.value}if(o){if(i.value){e.result=e.locals[a]=u}else{e.result=i.index}if(v){e.locals[v]=i.index}i.index++;return h}else{e.meta.iterators[E]=null;return r.findNext(this.parent,e)}}};e.setParent(h,T);var k={name:"repeatInit",args:[u,f,c],op:function(e,t,r,n){var i={iterator:undefined,index:0,value:t,eventFired:false};e.meta.iterators[E]=i;if(t&&t[Symbol.iterator]){i.iterator=t[Symbol.iterator]()}if(f){var a=n||e.me;a.addEventListener(r,(function(t){e.meta.iterators[E].eventFired=true}),{once:true})}return T},execute:function(e){return r.unifiedExec(this,e)}};e.setParent(T,k);return k};t.addCommand("repeat",(function(e,t,r){if(r.matchToken("repeat")){return x(e,r,t,false)}}));t.addCommand("for",(function(e,t,r){if(r.matchToken("for")){return x(e,r,t,true)}}));t.addCommand("continue",(function(e,t,r){if(!r.matchToken("continue"))return;var n={op:function(t){for(var n=this.parent;true;n=n.parent){if(n==undefined){e.raiseParseError(r,"Command `continue` cannot be used outside of a `repeat` loop.")}if(n.loop!=undefined){return n.resolveNext(t)}}}};return n}));t.addCommand("break",(function(e,t,r){if(!r.matchToken("break"))return;var n={op:function(n){for(var i=this.parent;true;i=i.parent){if(i==undefined){e.raiseParseError(r,"Command `continue` cannot be used outside of a `repeat` loop.")}if(i.loop!=undefined){return t.findNext(i.parent,n)}}}};return n}));t.addGrammarElement("stringLike",(function(e,t,r){return e.parseAnyOf(["string","nakedString"],r)}));t.addCommand("append",(function(e,t,r){if(!r.matchToken("append"))return;var n=null;var i=e.requireElement("expression",r);var a={type:"symbol",evaluate:function(e){return t.resolveSymbol("result",e)}};if(r.matchToken("to")){n=e.requireElement("expression",r)}else{n=a}var o=null;if(n.type==="symbol"||n.type==="attributeRef"||n.root!=null){o=k(e,t,r,n,a)}var u={value:i,target:n,args:[n,i],op:function(e,r,n){if(Array.isArray(r)){r.push(n);return t.findNext(this,e)}else if(r instanceof Element){r.innerHTML+=n;return t.findNext(this,e)}else if(o){e.result=(r||"")+n;return o}else{throw Error("Unable to append a value!")}},execute:function(e){return t.unifiedExec(this,e)}};if(o!=null){o.parent=u}return u}));function g(e,t,r){r.matchToken("at")||r.matchToken("from");var n={from:undefined,to:undefined,includeStart:true,includeEnd:false,toEnd:undefined};n.from=r.matchToken("start")?0:e.requireElement("expression",r);if(r.matchToken("to")||r.matchOpToken("..")){if(r.matchToken("end")){n.toEnd=true}else{n.to=e.requireElement("expression",r)}}if(r.matchToken("inclusive"))n.includeEnd=true;else if(r.matchToken("exclusive"))n.includeStart=false;return n}var b=function(){function e(e,t){this.re=e;this.str=t}e.prototype.next=function(){var e=this.re.exec(this.str);if(e===null)return{done:true};else return{value:e}};return e}();var w=function(){function e(e,t,r){this.re=e;this.flags=t;this.str=r}e.prototype[Symbol.iterator]=function(){return new b(new RegExp(this.re,this.flags),this.str)};return e}();t.addCommand("pick",(function(e,t,r){if(!r.matchToken("pick"))return;r.matchToken("the");if(r.matchToken("item")||r.matchToken("items")||r.matchToken("character")||r.matchToken("characters")){var n=g(e,t,r);r.requireToken("from");var i=e.requireElement("expression",r);return{args:[i,n.from,n.to],op:function(e,r,i,a){if(n.toEnd)a=r.length;if(!n.includeStart)i++;if(n.includeEnd)a++;if(a==null||a==undefined)a=i+1;e.result=r.slice(i,a);return t.findNext(this,e)}}}if(r.matchToken("match")){r.matchToken("of");var a=e.parseElement("expression",r);var o="";if(r.matchOpToken("|")){o=r.requireToken("identifier").value}r.requireToken("from");var i=e.parseElement("expression",r);return{args:[i,a],op:function(e,r,n){e.result=new RegExp(n,o).exec(r);return t.findNext(this,e)}}}if(r.matchToken("matches")){r.matchToken("of");var a=e.parseElement("expression",r);var u="gu";if(r.matchOpToken("|")){u="g"+r.requireToken("identifier").value.replace("g","")}console.log("flags",u);r.requireToken("from");var i=e.parseElement("expression",r);return{args:[i,a],op:function(e,r,n){e.result=new w(n,u,r);return t.findNext(this,e)}}}}));t.addCommand("increment",(function(e,t,r){if(!r.matchToken("increment"))return;var n;var i=e.parseElement("assignableExpression",r);if(r.matchToken("by")){n=e.requireElement("expression",r)}var a={type:"implicitIncrementOp",target:i,args:[i,n],op:function(e,t,r){t=t?parseFloat(t):0;r=n?parseFloat(r):1;var i=t+r;e.result=i;return i},evaluate:function(e){return t.unifiedEval(this,e)}};return k(e,t,r,i,a)}));t.addCommand("decrement",(function(e,t,r){if(!r.matchToken("decrement"))return;var n;var i=e.parseElement("assignableExpression",r);if(r.matchToken("by")){n=e.requireElement("expression",r)}var a={type:"implicitDecrementOp",target:i,args:[i,n],op:function(e,t,r){t=t?parseFloat(t):0;r=n?parseFloat(r):1;var i=t-r;e.result=i;return i},evaluate:function(e){return t.unifiedEval(this,e)}};return k(e,t,r,i,a)}));function S(e,t){var r="text";var n;e.matchToken("a")||e.matchToken("an");if(e.matchToken("json")||e.matchToken("Object")){r="json"}else if(e.matchToken("response")){r="response"}else if(e.matchToken("html")){r="html"}else if(e.matchToken("text")){}else{n=t.requireElement("dotOrColonPath",e).evaluate()}return{type:r,conversion:n}}t.addCommand("fetch",(function(e,t,r){if(!r.matchToken("fetch"))return;var n=e.requireElement("stringLike",r);if(r.matchToken("as")){var i=S(r,e)}if(r.matchToken("with")&&r.currentToken().value!=="{"){var a=e.parseElement("nakedNamedArgumentList",r)}else{var a=e.parseElement("objectLiteral",r)}if(i==null&&r.matchToken("as")){i=S(r,e)}var o=i?i.type:"text";var u=i?i.conversion:null;var s={url:n,argExpressions:a,args:[n,a],op:function(e,r,n){var i=n||{};i["sender"]=e.me;i["headers"]=i["headers"]||{};var a=new AbortController;var l=e.me.addEventListener("fetch:abort",(function(){a.abort()}),{once:true});i["signal"]=a.signal;t.triggerEvent(e.me,"hyperscript:beforeFetch",i);t.triggerEvent(e.me,"fetch:beforeRequest",i);n=i;var f=false;if(n.timeout){setTimeout((function(){if(!f){a.abort()}}),n.timeout)}return fetch(r,n).then((function(r){var n={response:r};t.triggerEvent(e.me,"fetch:afterResponse",n);r=n.response;if(o==="response"){e.result=r;t.triggerEvent(e.me,"fetch:afterRequest",{result:r});f=true;return t.findNext(s,e)}if(o==="json"){return r.json().then((function(r){e.result=r;t.triggerEvent(e.me,"fetch:afterRequest",{result:r});f=true;return t.findNext(s,e)}))}return r.text().then((function(r){if(u)r=t.convertValue(r,u);if(o==="html")r=t.convertValue(r,"Fragment");e.result=r;t.triggerEvent(e.me,"fetch:afterRequest",{result:r});f=true;return t.findNext(s,e)}))})).catch((function(r){t.triggerEvent(e.me,"fetch:error",{reason:r});throw r})).finally((function(){e.me.removeEventListener("fetch:abort",l)}))}};return s}))}function h(e){e.addCommand("settle",(function(e,t,r){if(r.matchToken("settle")){if(!e.commandBoundary(r.currentToken())){var n=e.requireElement("expression",r)}else{var n=e.requireElement("implicitMeTarget",r)}var i={type:"settleCmd",args:[n],op:function(e,r){t.nullCheck(r,n);var a=null;var o=false;var u=false;var s=new Promise((function(e){a=e}));r.addEventListener("transitionstart",(function(){u=true}),{once:true});setTimeout((function(){if(!u&&!o){a(t.findNext(i,e))}}),500);r.addEventListener("transitionend",(function(){if(!o){a(t.findNext(i,e))}}),{once:true});return s},execute:function(e){return t.unifiedExec(this,e)}};return i}}));e.addCommand("add",(function(e,t,r){if(r.matchToken("add")){var n=e.parseElement("classRef",r);var i=null;var a=null;if(n==null){i=e.parseElement("attributeRef",r);if(i==null){a=e.parseElement("styleLiteral",r);if(a==null){e.raiseParseError(r,"Expected either a class reference or attribute expression")}}}else{var o=[n];while(n=e.parseElement("classRef",r)){o.push(n)}}if(r.matchToken("to")){var u=e.requireElement("expression",r)}else{var u=e.requireElement("implicitMeTarget",r)}if(r.matchToken("when")){if(a){e.raiseParseError(r,"Only class and properties are supported with a when clause")}var s=e.requireElement("expression",r)}if(o){return{classRefs:o,to:u,args:[u,o],op:function(e,r,n){t.nullCheck(r,u);t.forEach(n,(function(n){t.implicitLoop(r,(function(r){if(s){e.result=r;var i=t.evaluateNoPromise(s,e);if(i){if(r instanceof Element)r.classList.add(n.className)}else{if(r instanceof Element)r.classList.remove(n.className)}e.result=null}else{if(r instanceof Element)r.classList.add(n.className)}}))}));return t.findNext(this,e)}}}else if(i){return{type:"addCmd",attributeRef:i,to:u,args:[u],op:function(e,r,n){t.nullCheck(r,u);t.implicitLoop(r,(function(r){if(s){e.result=r;var n=t.evaluateNoPromise(s,e);if(n){r.setAttribute(i.name,i.value)}else{r.removeAttribute(i.name)}e.result=null}else{r.setAttribute(i.name,i.value)}}));return t.findNext(this,e)},execute:function(e){return t.unifiedExec(this,e)}}}else{return{type:"addCmd",cssDeclaration:a,to:u,args:[u,a],op:function(e,r,n){t.nullCheck(r,u);t.implicitLoop(r,(function(e){e.style.cssText+=n}));return t.findNext(this,e)},execute:function(e){return t.unifiedExec(this,e)}}}}}));e.addGrammarElement("styleLiteral",(function(e,t,r){if(!r.matchOpToken("{"))return;var n=[""];var i=[];while(r.hasMore()){if(r.matchOpToken("\\")){r.consumeToken()}else if(r.matchOpToken("}")){break}else if(r.matchToken("$")){var a=r.matchOpToken("{");var o=e.parseElement("expression",r);if(a)r.requireOpToken("}");i.push(o);n.push("")}else{var u=r.consumeToken();n[n.length-1]+=r.source.substring(u.start,u.end)}n[n.length-1]+=r.lastWhitespace()}return{type:"styleLiteral",args:[i],op:function(e,t){var r="";n.forEach((function(e,n){r+=e;if(n in t)r+=t[n]}));return r},evaluate:function(e){return t.unifiedEval(this,e)}}}));e.addCommand("remove",(function(e,t,r){if(r.matchToken("remove")){var n=e.parseElement("classRef",r);var i=null;var a=null;if(n==null){i=e.parseElement("attributeRef",r);if(i==null){a=e.parseElement("expression",r);if(a==null){e.raiseParseError(r,"Expected either a class reference, attribute expression or value expression")}}}else{var o=[n];while(n=e.parseElement("classRef",r)){o.push(n)}}if(r.matchToken("from")){var u=e.requireElement("expression",r)}else{if(a==null){var u=e.requireElement("implicitMeTarget",r)}}if(a){return{elementExpr:a,from:u,args:[a,u],op:function(e,r,n){t.nullCheck(r,a);t.implicitLoop(r,(function(e){if(e.parentElement&&(n==null||n.contains(e))){e.parentElement.removeChild(e)}}));return t.findNext(this,e)}}}else{return{classRefs:o,attributeRef:i,elementExpr:a,from:u,args:[o,u],op:function(e,r,n){t.nullCheck(n,u);if(r){t.forEach(r,(function(e){t.implicitLoop(n,(function(t){t.classList.remove(e.className)}))}))}else{t.implicitLoop(n,(function(e){e.removeAttribute(i.name)}))}return t.findNext(this,e)}}}}}));e.addCommand("toggle",(function(e,t,r){if(r.matchToken("toggle")){r.matchAnyToken("the","my");if(r.currentToken().type==="STYLE_REF"){var n=r.consumeToken();var a=n.value.substr(1);var o=true;var u=i(e,r,a);if(r.matchToken("of")){r.pushFollow("with");try{var s=e.requireElement("expression",r)}finally{r.popFollow()}}else{var s=e.requireElement("implicitMeTarget",r)}}else if(r.matchToken("between")){var l=true;var f=e.parseElement("classRef",r);r.requireToken("and");var c=e.requireElement("classRef",r)}else{var f=e.parseElement("classRef",r);var p=null;if(f==null){p=e.parseElement("attributeRef",r);if(p==null){e.raiseParseError(r,"Expected either a class reference or attribute expression")}}else{var m=[f];while(f=e.parseElement("classRef",r)){m.push(f)}}}if(o!==true){if(r.matchToken("on")){var s=e.requireElement("expression",r)}else{var s=e.requireElement("implicitMeTarget",r)}}if(r.matchToken("for")){var v=e.requireElement("expression",r)}else if(r.matchToken("until")){var h=e.requireElement("dotOrColonPath",r,"Expected event name");if(r.matchToken("from")){var d=e.requireElement("expression",r)}}var y={classRef:f,classRef2:c,classRefs:m,attributeRef:p,on:s,time:v,evt:h,from:d,toggle:function(e,r,n,i){t.nullCheck(e,s);if(o){t.implicitLoop(e,(function(e){u("toggle",e)}))}else if(l){t.implicitLoop(e,(function(e){if(e.classList.contains(r.className)){e.classList.remove(r.className);e.classList.add(n.className)}else{e.classList.add(r.className);e.classList.remove(n.className)}}))}else if(i){t.forEach(i,(function(r){t.implicitLoop(e,(function(e){e.classList.toggle(r.className)}))}))}else{t.forEach(e,(function(e){if(e.hasAttribute(p.name)){e.removeAttribute(p.name)}else{e.setAttribute(p.name,p.value)}}))}},args:[s,v,h,d,f,c,m],op:function(e,r,n,i,a,o,u,s){if(n){return new Promise((function(i){y.toggle(r,o,u,s);setTimeout((function(){y.toggle(r,o,u,s);i(t.findNext(y,e))}),n)}))}else if(i){return new Promise((function(n){var l=a||e.me;l.addEventListener(i,(function(){y.toggle(r,o,u,s);n(t.findNext(y,e))}),{once:true});y.toggle(r,o,u,s)}))}else{this.toggle(r,o,u,s);return t.findNext(y,e)}}};return y}}));var t={display:function(r,n,i){if(i){n.style.display=i}else if(r==="toggle"){if(getComputedStyle(n).display==="none"){t.display("show",n,i)}else{t.display("hide",n,i)}}else if(r==="hide"){var a=e.runtime.getInternalData(n);if(a.originalDisplay==null){a.originalDisplay=n.style.display}n.style.display="none"}else{var a=e.runtime.getInternalData(n);if(a.originalDisplay&&a.originalDisplay!=="none"){n.style.display=a.originalDisplay}else{n.style.removeProperty("display")}}},visibility:function(e,r,n){if(n){r.style.visibility=n}else if(e==="toggle"){if(getComputedStyle(r).visibility==="hidden"){t.visibility("show",r,n)}else{t.visibility("hide",r,n)}}else if(e==="hide"){r.style.visibility="hidden"}else{r.style.visibility="visible"}},opacity:function(e,r,n){if(n){r.style.opacity=n}else if(e==="toggle"){if(getComputedStyle(r).opacity==="0"){t.opacity("show",r,n)}else{t.opacity("hide",r,n)}}else if(e==="hide"){r.style.opacity="0"}else{r.style.opacity="1"}}};var n=function(e,t,r){var n;var i=r.currentToken();if(i.value==="when"||i.value==="with"||e.commandBoundary(i)){n=e.parseElement("implicitMeTarget",r)}else{n=e.parseElement("expression",r)}return n};var i=function(e,n,i){var a=r.defaultHideShowStrategy;var o=t;if(r.hideShowStrategies){o=Object.assign(o,r.hideShowStrategies)}i=i||a||"display";var u=o[i];if(u==null){e.raiseParseError(n,"Unknown show/hide strategy : "+i)}return u};e.addCommand("hide",(function(e,t,r){if(r.matchToken("hide")){var a=n(e,t,r);var o=null;if(r.matchToken("with")){o=r.requireTokenType("IDENTIFIER","STYLE_REF").value;if(o.indexOf("*")===0){o=o.substr(1)}}var u=i(e,r,o);return{target:a,args:[a],op:function(e,r){t.nullCheck(r,a);t.implicitLoop(r,(function(e){u("hide",e)}));return t.findNext(this,e)}}}}));e.addCommand("show",(function(e,t,r){if(r.matchToken("show")){var a=n(e,t,r);var o=null;if(r.matchToken("with")){o=r.requireTokenType("IDENTIFIER","STYLE_REF").value;if(o.indexOf("*")===0){o=o.substr(1)}}var u=null;if(r.matchOpToken(":")){var s=r.consumeUntilWhitespace();r.matchTokenType("WHITESPACE");u=s.map((function(e){return e.value})).join("")}if(r.matchToken("when")){var l=e.requireElement("expression",r)}var f=i(e,r,o);return{target:a,when:l,args:[a],op:function(e,r){t.nullCheck(r,a);t.implicitLoop(r,(function(r){if(l){e.result=r;var n=t.evaluateNoPromise(l,e);if(n){f("show",r,u)}else{f("hide",r)}e.result=null}else{f("show",r,u)}}));return t.findNext(this,e)}}}}));e.addCommand("take",(function(e,t,r){if(r.matchToken("take")){var n=e.requireElement("classRef",r);if(r.matchToken("from")){var i=e.requireElement("expression",r)}else{var i=n}if(r.matchToken("for")){var a=e.requireElement("expression",r)}else{var a=e.requireElement("implicitMeTarget",r)}var o={classRef:n,from:i,forElt:a,args:[n,i,a],op:function(e,r,n,o){t.nullCheck(n,i);t.nullCheck(o,a);var u=r.className;t.implicitLoop(n,(function(e){e.classList.remove(u)}));t.implicitLoop(o,(function(e){e.classList.add(u)}));return t.findNext(this,e)}};return o}}));function a(t,r,n,i){if(n!=null){var a=t.resolveSymbol(n,r)}else{var a=r}if(a instanceof Element||a instanceof HTMLDocument){while(a.firstChild)a.removeChild(a.firstChild);a.append(e.runtime.convertValue(i,"Fragment"));t.processNode(a)}else{if(n!=null){t.setSymbol(n,r,null,i)}else{throw"Don't know how to put a value into "+typeof r}}}e.addCommand("put",(function(e,t,r){if(r.matchToken("put")){var n=e.requireElement("expression",r);var i=r.matchAnyToken("into","before","after");if(i==null&&r.matchToken("at")){r.matchToken("the");i=r.matchAnyToken("start","end");r.requireToken("of")}if(i==null){e.raiseParseError(r,"Expected one of 'into', 'before', 'at start of', 'at end of', 'after'")}var o=e.requireElement("expression",r);var u=i.value;var s=false;var l=false;var f=null;var c=null;if(o.type==="arrayIndex"&&u==="into"){s=true;c=o.prop;f=o.root}else if(o.prop&&o.root&&u==="into"){c=o.prop.value;f=o.root}else if(o.type==="symbol"&&u==="into"){l=true;c=o.name}else if(o.type==="attributeRef"&&u==="into"){var p=true;c=o.name;f=e.requireElement("implicitMeTarget",r)}else if(o.type==="styleRef"&&u==="into"){var m=true;c=o.name;f=e.requireElement("implicitMeTarget",r)}else if(o.attribute&&u==="into"){var p=o.attribute.type==="attributeRef";var m=o.attribute.type==="styleRef";c=o.attribute.name;f=o.root}else{f=o}var v={target:o,operation:u,symbolWrite:l,value:n,args:[f,c,n],op:function(e,r,n,i){if(l){a(t,e,n,i)}else{t.nullCheck(r,f);if(u==="into"){if(p){t.implicitLoop(r,(function(e){e.setAttribute(n,i)}))}else if(m){t.implicitLoop(r,(function(e){e.style[n]=i}))}else if(s){r[n]=i}else{t.implicitLoop(r,(function(e){a(t,e,n,i)}))}}else{var o=u==="before"?Element.prototype.before:u==="after"?Element.prototype.after:u==="start"?Element.prototype.prepend:u==="end"?Element.prototype.append:Element.prototype.append;t.implicitLoop(r,(function(e){o.call(e,i instanceof Node?i:t.convertValue(i,"Fragment"));if(e.parentElement){t.processNode(e.parentElement)}else{t.processNode(e)}}))}}return t.findNext(this,e)}};return v}}));function o(e,t,r){var n;if(r.matchToken("the")||r.matchToken("element")||r.matchToken("elements")||r.currentToken().type==="CLASS_REF"||r.currentToken().type==="ID_REF"||r.currentToken().op&&r.currentToken().value==="<"){e.possessivesDisabled=true;try{n=e.parseElement("expression",r)}finally{delete e.possessivesDisabled}if(r.matchOpToken("'")){r.requireToken("s")}}else if(r.currentToken().type==="IDENTIFIER"&&r.currentToken().value==="its"){var i=r.matchToken("its");n={type:"pseudopossessiveIts",token:i,name:i.value,evaluate:function(e){return t.resolveSymbol("it",e)}}}else{r.matchToken("my")||r.matchToken("me");n=e.parseElement("implicitMeTarget",r)}return n}e.addCommand("transition",(function(e,t,n){if(n.matchToken("transition")){var i=o(e,t,n);var a=[];var u=[];var s=[];var l=n.currentToken();var f=function(){if(n.currentToken().type==="STYLE_REF"){var t=n.consumeToken();var r=t.value.substr(1);a.push({type:"styleRefValue",evaluate:function(){return r}})}else{a.push(e.requireElement("stringLike",n))}if(n.matchToken("from")){u.push(e.requireElement("expression",n))}else{u.push(null)}n.requireToken("to");if(n.matchToken("initial")){s.push({type:"initial_literal",evaluate:function(){return"initial"}})}else{s.push(e.requireElement("expression",n))}l=n.currentToken()};while(!e.commandBoundary(l)&&l.value!=="over"&&l.value!=="using"){f()}if(n.matchToken("over")){var c=e.requireElement("expression",n)}else if(n.matchToken("using")){var p=e.requireElement("expression",n)}var m={to:s,args:[i,a,u,s,p,c],op:function(e,n,a,o,u,s,l){t.nullCheck(n,i);var f=[];t.implicitLoop(n,(function(e){var n=new Promise((function(n,i){var f=e.style.transition;if(l){e.style.transition="all "+l+"ms ease-in"}else if(s){e.style.transition=s}else{e.style.transition=r.defaultTransition}var c=t.getInternalData(e);var p=getComputedStyle(e);var m={};for(var v=0;v<p.length;v++){var h=p[v];var d=p[h];m[h]=d}if(!c.initalStyles){c.initalStyles=m}for(var v=0;v<a.length;v++){var y=a[v];var E=o[v];if(E==="computed"||E==null){e.style[y]=m[y]}else{e.style[y]=E}}var T=false;var k=false;e.addEventListener("transitionend",(function(){if(!k){e.style.transition=f;k=true;n(undefined)}}),{once:true});e.addEventListener("transitionstart",(function(){T=true}),{once:true});setTimeout((function(){if(!k&&!T){e.style.transition=f;k=true;n(undefined)}}),100);setTimeout((function(){var t=[];for(var r=0;r<a.length;r++){var n=a[r];var i=u[r];if(i==="initial"){var o=c.initalStyles[n];e.style[n]=o}else{e.style[n]=i}}}),0)}));f.push(n)}));return Promise.all(f).then((function(){return t.findNext(m,e)}))}};return m}}));e.addCommand("measure",(function(e,t,r){if(!r.matchToken("measure"))return;var n=o(e,t,r);var i=[];if(!e.commandBoundary(r.currentToken()))do{i.push(r.matchTokenType("IDENTIFIER").value)}while(r.matchOpToken(","));return{properties:i,args:[n],op:function(e,r){t.nullCheck(r,n);if(0 in r)r=r[0];var a=r.getBoundingClientRect();var o={top:r.scrollTop,left:r.scrollLeft,topMax:r.scrollTopMax,leftMax:r.scrollLeftMax,height:r.scrollHeight,width:r.scrollWidth};e.result={x:a.x,y:a.y,left:a.left,top:a.top,right:a.right,bottom:a.bottom,width:a.width,height:a.height,bounds:a,scrollLeft:o.left,scrollTop:o.top,scrollLeftMax:o.leftMax,scrollTopMax:o.topMax,scrollWidth:o.width,scrollHeight:o.height,scroll:o};t.forEach(i,(function(t){if(t in e.result)e.locals[t]=e.result[t];else throw"No such measurement as "+t}));return t.findNext(this,e)}}}));e.addLeafExpression("closestExpr",(function(e,t,r){if(r.matchToken("closest")){if(r.matchToken("parent")){var n=true}var i=null;if(r.currentToken().type==="ATTRIBUTE_REF"){var a=e.requireElement("attributeRefAccess",r,null);i="["+a.attribute.name+"]"}if(i==null){var o=e.requireElement("expression",r);if(o.css==null){e.raiseParseError(r,"Expected a CSS expression")}else{i=o.css}}if(r.matchToken("to")){var u=e.parseElement("expression",r)}else{var u=e.parseElement("implicitMeTarget",r)}var s={type:"closestExpr",parentSearch:n,expr:o,css:i,to:u,args:[u],op:function(e,r){if(r==null){return null}else{var a=[];t.implicitLoop(r,(function(e){if(n){a.push(e.parentElement?e.parentElement.closest(i):null)}else{a.push(e.closest(i))}}));if(t.shouldAutoIterate(r)){return a}else{return a[0]}}},evaluate:function(e){return t.unifiedEval(this,e)}};if(a){a.root=s;a.args=[s];return a}else{return s}}}));e.addCommand("go",(function(e,t,r){if(r.matchToken("go")){if(r.matchToken("back")){var n=true}else{r.matchToken("to");if(r.matchToken("url")){var i=e.requireElement("stringLike",r);var a=true;if(r.matchToken("in")){r.requireToken("new");r.requireToken("window");var o=true}}else{r.matchToken("the");var u=r.matchAnyToken("top","middle","bottom");var s=r.matchAnyToken("left","center","right");if(u||s){r.requireToken("of")}var i=e.requireElement("unaryExpression",r);var l=r.matchAnyOpToken("+","-");if(l){r.pushFollow("px");try{var f=e.requireElement("expression",r)}finally{r.popFollow()}}r.matchToken("px");var c=r.matchAnyToken("smoothly","instantly");var p={};if(u){if(u.value==="top"){p.block="start"}else if(u.value==="bottom"){p.block="end"}else if(u.value==="middle"){p.block="center"}}if(s){if(s.value==="left"){p.inline="start"}else if(s.value==="center"){p.inline="center"}else if(s.value==="right"){p.inline="end"}}if(c){if(c.value==="smoothly"){p.behavior="smooth"}else if(c.value==="instantly"){p.behavior="instant"}}}}var m={target:i,args:[i,f],op:function(e,r,i){if(n){window.history.back()}else if(a){if(r){if(o){window.open(r)}else{window.location.href=r}}}else{t.implicitLoop(r,(function(e){if(e===window){e=document.body}if(l){var t=e.getBoundingClientRect();var r=document.createElement("div");if(l.value==="-"){var n=-i}else{var n=- -i}r.style.position="absolute";r.style.top=t.x+n+"px";r.style.left=t.y+n+"px";r.style.height=t.height+2*n+"px";r.style.width=t.width+2*n+"px";r.style.zIndex=""+Number.MIN_SAFE_INTEGER;r.style.opacity="0";document.body.appendChild(r);setTimeout((function(){document.body.removeChild(r)}),100);e=r}e.scrollIntoView(p)}))}return t.findNext(m,e)}};return m}}));r.conversions.dynamicResolvers.push((function(t,r){if(!(t==="Values"||t.indexOf("Values:")===0)){return}var n=t.split(":")[1];var i={};var a=e.runtime.implicitLoop.bind(e.runtime);a(r,(function(e){var t=u(e);if(t!==undefined){i[t.name]=t.value;return}if(e.querySelectorAll!=undefined){var r=e.querySelectorAll("input,select,textarea");r.forEach(o)}}));if(n){if(n==="JSON"){return JSON.stringify(i)}else if(n==="Form"){return new URLSearchParams(i).toString()}else{throw"Unknown conversion: "+n}}else{return i}function o(e){var t=u(e);if(t==undefined){return}if(i[t.name]==undefined){i[t.name]=t.value;return}if(Array.isArray(i[t.name])&&Array.isArray(t.value)){i[t.name]=[].concat(i[t.name],t.value);return}}function u(e){try{var t={name:e.name,value:e.value};if(t.name==undefined||t.value==undefined){return undefined}if(e.type=="radio"&&e.checked==false){return undefined}if(e.type=="checkbox"){if(e.checked==false){t.value=undefined}else if(typeof t.value==="string"){t.value=[t.value]}}if(e.type=="select-multiple"){var r=e.querySelectorAll("option[selected]");t.value=[];for(var n=0;n<r.length;n++){t.value.push(r[n].value)}}return t}catch(e){return undefined}}}));r.conversions["HTML"]=function(e){var t=function(e){if(e instanceof Array){return e.map((function(e){return t(e)})).join("")}if(e instanceof HTMLElement){return e.outerHTML}if(e instanceof NodeList){var r="";for(var n=0;n<e.length;n++){var i=e[n];if(i instanceof HTMLElement){r+=i.outerHTML}}return r}if(e.toString){return e.toString()}return""};return t(e)};r.conversions["Fragment"]=function(t){var r=document.createDocumentFragment();e.runtime.implicitLoop(t,(function(e){if(e instanceof Node)r.append(e);else{var t=document.createElement("template");t.innerHTML=e;r.append(t.content)}}));return r}}var d=new o,y=d.lexer,E=d.parser;function T(e,t){if(t===void 0){t=undefined}return d.evaluate(e,t)}function k(){var t=Array.from(e.document.querySelectorAll("script[type='text/hyperscript'][src]"));Promise.all(t.map((function(e){return fetch(e.src).then((function(e){return e.text()}))}))).then((function(e){return e.forEach((function(e){return x(e)}))})).then((function(){return n((function(){a();d.processNode(document.documentElement);e.document.addEventListener("htmx:load",(function(e){d.processNode(e.detail.elt)}))}))}));function n(e){if(document.readyState!=="loading"){setTimeout(e)}else{document.addEventListener("DOMContentLoaded",e)}}function i(){var e=document.querySelector('meta[name="htmx-config"]');if(e){return c(e["content"])}else{return null}}function a(){var e=i();if(e){Object.assign(r,e)}}}var x=Object.assign(T,{config:r,use:function(e){e(x)},internals:{lexer:y,parser:E,runtime:d,Lexer:n,Tokens:i,Parser:a,Runtime:o},ElementCollection:s,addFeature:E.addFeature.bind(E),addCommand:E.addCommand.bind(E),addLeafExpression:E.addLeafExpression.bind(E),addIndirectExpression:E.addIndirectExpression.bind(E),evaluate:d.evaluate.bind(d),parse:d.parse.bind(d),processNode:d.processNode.bind(d),browserInit:k});return x}));
